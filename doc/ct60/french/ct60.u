!tex \documentstyle[11pt]{article}
!stg @subject "Documentation"
!french
!title   Documentation de la
!programimage ..\img\ct60.img
!program CT60
!version Version 2.00
!date    (!today)
!author  Didier MEQUIGNON
!street  25, rue de l'Ascenseur
!town    62510 ARQUES FRANCE
!email   aniplay@wanadoo.fr
!use_auto_subtocs    [info,html,stg,tvh,win]
!use_auto_subsubtocs [info,html,stg,tvh,win]
!no_effects          [asc]
!begin_document
!maketitle
!tableofcontents

!node Presentation

(!B)
Par Rodolphe Czuba
(!b)

Vous en avez marre de compiler du code … la vitesse d'un escargot ?

Vous voulez surfer rapidement sur le Web ?

Vous voulez calculer des images sous POV, faire de la PAO ou de la 
retouche photo … une vitesse descente ?

Vous avez envie d'exploiter convenablement des applications comme un 
encoder MP3 ou une console Java sous Mint ? 

Vous voulez conserver la totalit‚ de votre logith‚que ?

Vous ne voulez pas vous s‚parer de tout ce qui fait le charme du Falcon, 
son systŠme sonore, son DSP et toute sa connectique en standard (SCSI, 
prises midi, ports Joystick, etc...) ? 

Pour ceux qui n'ont pas franchie le pas ou qui ne trouvent plus de cartes 
acc‚l‚ratrice, c'est le moment !

Ne mettez pas votre Falcon … la retraite !


!subnode Caract‚ristiques G‚n‚rales

!begin_itemize

!item  SUR SUPPORT : 
68060 FULL(AVEC COPRO & PMMU) ou LC (SANS COPRO) … 66 MHz (masque 
1F43G) ou 100 MHz (masque 1E41J).

!item Bus CT60 … 66 MHz ou 100 MHz (accŠs SDRAM, BUS 060).

!item SDRAM … 66 MHz (de base) avec acces BURST en LECTURE & ECRITURE.

!item 1 support SDRAM PC100/133 pour 64 Mo … 512 Mo.

!item FLASH 1Mo avec BOOT, SET UP, 060 INIT et patchs du TOS.

!item Switch pour choisir entre le 060 et le 030 du Falcon.

!item Installation simple SANS SOUDURES dans le boitier d'origine du Falcon, 
sans l'alimentation Falcon qui est remplac‚e par une alimentation ATX 
Externe (ou dans un tower ATX).  

!item Mode Falcon 030 … 100 % d'origine. 68882 utilisable en mode 030.

!item Bus d'Extension 060 pour cartes filles (PCI/AGP, PowerPC, etc...).

!item OPTION de boost du Falcon avec 6 fils … souder : DSP & VIDEL … 40 MHz, 
Bus … 20 MHz. 

!end_itemize 


!subnode Processeur

Dans sa version FULL, le MC68060, comme le MC68040, int‚gre un 
Coprocesseur bien plus performant que le 68882. 

Dans sa version LC, le 060 n'a pas de Copro, ce processeur n'est plus 
support‚ depuis le boot 2.00.

Dans sa version EC, le 060 n'a ni de Copro, ni de PMMU, ce processeur n'est 
plus support‚ depuis le boot 2.00.

Le 060 fait rˆver et la premiŠre raison est sa puissance colossale face … 
ses pr‚d‚cesseurs :

!begin_table [|l|l|l|] !hline
CPU                                        !! MIPS  !! FACTEUR
!hline
68060 @ 100 MHz (CT60-100)                 !! 147   !! 25,5
68060 @ 75 MHz (De Motorola 2001)          !! 110   !! 19,1
68060 @ 66 MHz (CT60)                      !! 96,8  !! 16,8
68060 @ 59 MHz (HADES60)                   !! 86,5  !! 15,0
68040 @ 40 MHz (AB40 … 40 / Motorola 2001) !! 44    !! 7,6
68040 @ 32 MHz (HADES40 & AB40 … 32)       !! 35,2  !! 6,1
68040 @ 25 MHz (MILAN40)                   !! 27,5  !! 4,8
68030 @ 50 MHz (CT2)                       !! 18    !! 3,1
68030 @ 32 MHz (TT030)                     !! 11,5  !! 2,0
68030 @ 16 MHz (Falcon/Motorola 2001)      !! 5,76  !! 1,0
!hline
!end_table


!subnode RAM

Au-dela de 40 MHz, la SDRAM est acc‚d‚e en 1 cycle alors que l'EDO 60ns a 
besoin de 2 cycles. 

La RAM de la CT60 est ‚quivalente … la TT-Ram (mˆme adresse : $01000000).

La CT60 est le seul produit TOS … utiliser de la SDRAM ! Les performances 
s'en ressentent fortement : 

!begin_table [|l|l|l|l|l|l|] !hline
PRODUIT        !! BUS      !! RAM   !! LECTURE	  !! ECRITURE   !! FACTEUR
!hline
CT60-95-CTPCI  !!  95 MHz  !! SDRAM !!  92,9 Mo/s !!  91,6 Mo/S !! 20.4 - 16.6
CT60-100       !! 100 MHz  !! SDRAM !! 104,4 Mo/s !! 102,8 Mo/s !! 22,9 - 18,7
CT60           !! 66 MHz   !! SDRAM !!  73,8 Mo/s !!  72,6 Mo/s !! 16,2 - 13,2
HADES60 FPM    !! 29,5 MHz !! FPM   !!  43,0 Mo/s !!  33,5 Mo/s !! 9,5 - 6,1
HADES40 FPM    !! 32 MHz   !! FPM   !!  46,5 Mo/s !!  36,2 Mo/s !! 10,2 - 6,6
MILAN40        !! 25 MHz   !! EDO   !!  35,7 Mo/s !!  21,5 Mo/s !! 7,8 - 3,9
CT2b           !! 50 MHz   !! EDO   !!  32,4 Mo/s !!  38,7 Mo/s !! 7,1 - 7,0
AB40           !! 32 MHz   !! FPM   !!  34,6 Mo/s !!  17,0 Mo/s !! 7,6 - 3,1
MEDUSA T40     !! 16 MHz   !! FPM   !!  20,0 Mo/s !!  21,9 Mo/s !! 4,4 - 4,0
TT030 TT-RAM   !! 16 MHz   !! FPM   !!  12,6 Mo/s !!  15,6 Mo/s !! 2,8 - 2,8
TT030 ST-RAM   !! 16 MHz   !! FPM   !!  7,9 Mo/s  !!  7,9 Mo/s  !! 1,7 - 1,4
FALCON+MAGNUM  !! 16 MHz   !! FPM   !!  5,7 Mo/s  !!  6,9 Mo/s  !! 1,25 - 1,25
FALCON(VGA16c) !! 16 MHz   !! FPM   !!  4,55 Mo/s !!  5,5 Mo/s  !! 1,00 - 1,00
!hline
!end_table

TESTS REALISES AVEC NEMBENCH 2.1 en 2003 et 2010 pour la CTPCI


!subnode Overclocking de la carte m‚re du FALCON !

Il est possible de booster le Falcon de 16 … 20 MHz, mais ceci n‚cessite 
alors 6 fils … souder sur la carte m‚re... Dans ce cas le DSP et VIDEL 
sont … 40 MHz et le bus du falcon … 20 MHz.  


!subnode Montage sans soudures !

La CT60 est PLUG'N PLAY !

Les pr‚c‚dentes cartes acc‚l‚ratrices ont toujours demand‚ de couper et 
souder sur la carte du Falcon, mais maintenant, grƒce … une conception 
hardware r‚volutionnaire, la carte m‚re n'est pas touch‚e par le montage.

Depuis un Falcon de base, il n'y a AUCUNE SOUDURE pour installer la CT60 !
La CT60 ne boost pas la carte m‚re du Falcon.

La CT60 fonctionne aussi sur un Falcon acc‚l‚r‚ avec tous les boosters 
(sous r‚serve de leur fiabilit‚ !) sauf la CT2... 

Pour les possesseurs de CT2, il est n‚cessaire de remettre le Falcon dans 
son ‚tat original.
Ce qui signifie que ceux qui enl‚vent une CT2 doivent replacer les GAL 
U62,63,67,68 et U44 et le 030 si il a ‚t‚ dessoud‚.
Les timings des ‚quations de ces GAL n'‚taient pas compatibles avec les 
acc‚s … 50 MHz de la CT2, en particulier pour le DSP. Mais la CT60 acc‚de 
au Falcon … 16 MHz, ce qui n'a jamais pos‚ de probl‚me dans ces GAL.
Si vous n'avez plus ces composants, ils seront fournis et le CPU sera 
soud‚ gratuitement. 

Mais acqu‚rir un Falcon 'vierge' est plus simple...


!subnode Connecteur BUS 060

La CT60 peut ‚voluer ! Les bus du 060 (donn‚es, adresses et contr“les) 
sont pr‚sents sur deux connecteurs HE13 de 2x25 broches, soit un total de 
100 broches.  

La premi‚re extension qui pourra voir le jour est un adaptateur PCI. Ce 
dernier sera tr‚s performant puisque le 060 y acc‚dera en 32 bits et … 66 
MHz, soit 8 fois plus vite que l'actuel ou futur (?) adaptateur Eclipse 
qui est sur le bus Falcon en 16 bits … 16 MHz : 66/16 MHz = 4,1 et 32/16 
bits = 2. Bien sur, une nouvelle Eclipse en 32-bit et avec le protocole 
bus 060 serait une bonne solution aussi... 

Et pourquoi pas un adaptateur AGP 1x 66 MHz...?

Une carte PPC est aussi possible puisque le connecteur bus peut ˆtre 
MASTER, l'arbitration avec le 060 ‚tant d‚ja pr‚sente dans la logique de 
la CT60...  

Dans tous les cas, les d‚veloppeurs software et hardware sont les bienvenus.


!subnode Cartes BUS FALCON

TOUTES les cartes du bus Falcon sont compatibles avec la CT60 !

Les cartes Screen Eyes, Expose, Nova, Eclipse, Tempest (pourquoi pas) 
peuvent ˆtre utilis‚es avec la CT60 puisque cette derniŠre ne modifie pas 
le hardware du Connecteur de bus Falcon (pas de soudures pour 
l'installation).   

La CT60 ne fourni pas de report de bus Falcon puisqu'il n'y en a pas 
besoin ! La methode est simple : laissez votre ancienne carte sur le 
connecteur bus et soudez 2 connecteurs HE13 mƒle/mƒle (2x15 & 2x25) sur 
cette carte et pluggez la CT60 dessus ! Bien sur, dans cette 
configuration, le clavier doit ˆtre sorti du boitier du Falcon...


!subnode Alimentation ATX

La CT60 a besoin d'une tension de 3.3 V avec au moins 8 Amp‚res pour le 
060, la SDRAM, le port BUS 060, la logique et les buffers, et 
l'alimentation du Falcon aurait ‚t‚ insuffisante dans le cas d'une 
conversion (co–teuse et de faible rendement) 5V->3.3V sur la CT60. Une 
alimentation ATX est donc obligatoire et remplace l'alimentation du Falcon 
lib‚rant ainsi la place pour la CT60. 

Les Alimentation ATX 250 Watts, avec interrupteur ON/OFF sont disponibles 
un peu partout pour 29 EUR environ. 


!subnode Tower ATX

La CT60 est ‚quip‚e d'un connecteur pour venir raccorder (sans soudures) 
les diff‚rentes fonctions de la fa‡ade d'un tower moderne : Led POWER, Led 
IDE, poussoir RESET, poussoir POWER ON/OFF. Et en plus (mais pas pr‚sent 
sur les fa‡ades de tower ATX), un commutateur NORMAL/TURBO (pas n‚cessaire 
si vous restez en mode 060).

Avec le switch POWER, vous pouvez allumer votre falcon. Il faut bien 
comprendre que les alimentation ATX n'ont pas (pour la plupart) de 
commutateur 220V car elle sont pilot‚es par les fonctions ACPI des OS 
modernes qui permettent de placer le micro en veille et non de l'‚teindre 
compl‚tement. Ce passage en veille se fait par le poussoir en fa‡ade et la 
CT60 g‚re cette fonction !

Une fonction SLEEP a mˆme ‚t‚ rajout‚e dans le hardware pilotable par le 
logiciel (un ACC ou CPX) pour passer la machine en veille (comme le menu 
'Arrˆter' de Windows). 

La led Power a une double fonction g‚r‚e par la CT60 : Lorsque 
l'alimentation est ON, la led est ‚clair‚e normalement, et lorsque 
l'alimentation est OFF (veille), la led a une luminosit‚ r‚duite vous 
rappellant ainsi que votre machine est en veille.   


!subnode Mode FALCON

Le 030 vous permet de lancer les vieux logiciels qui ne fonctionneront pas 
sur le 060 et de copier/patcher le TOS dans la Flash de la CT60.

Les patchs de la PMMU et des routines DSP sont n‚cessaires, par exemple.

La Flash est accessible depuis le 030 comme depuis le 060 et permettra … 
tous les codeurs de personnaliser leur systŠme … volont‚. 

Le mode Falcon vous offre un Falcon d'origine et vous assure que tous les 
logiciels fonctionnent comme avant! 

Les petits problŠmes de la CT2, comme l'Int DSP, la FAST-Ram remapp‚e avec 
la PMMU ou le Bus Error en dessous de $400 sont oubli‚s.


!node SDRAM

(!B)
Par Rodolphe Czuba
(!b)

La CT60 ne fonctionne pas sans SDRAM !

La CT60 utilise les DIMMs SDRAM du standard PC100/133, mais certaines 
DIMMs obsol‚tes (en PC100) ou non utiles ne sont pas accept‚es. 

En g‚n‚ral, le march‚ PC fourni des 64-bits 'Unbuffured', ce dont vous 
avez besoin pour la CT60. 

REMARQUE :

Ne confondez pas 'banks (logiques) SDRAM' (2 ou 4 dans une puce) avec 
'banks (physiques) DIMM' (Barette simple ou double face) !  


LES DIMMs SDRAM POUR CT60 :

!begin_itemize

!item Doit ˆtre PC100 ou PC133 CL2.

!item Doit ˆtre UNBUFFURED.

!item Doit ˆtre peupl‚e avec des puces SDRAMs de 4 banks (les 2 banks, 
obsol‚tes, sont refus‚es).

!item 64 Bits.  Pas de parit‚ ou ECC (72 ou 80 Bits).

!end_itemize 
!begin_table [|l|c|c|l|l|] !hline
Module !! Nbre puces !! Nbre faces !! Organisation  !! PAGE
!hline
64 Mo  !!     4      !!     2      !! 4M x 16 bits  !!  4Ko
64 Mo  !!     8      !!     1      !! 8M x 8 bits   !!  8Ko
64 Mo  !!     4      !!     1      !! 8M x 16 bits  !!  8Ko
128 Mo !!     8      !!     2      !! 8M x 8 bits   !!  8Ko
128 Mo !!     4      !!     2      !! 8M x 16 bits  !!  8Ko
128 Mo !!     8      !!     1      !! 16M x 8 bits  !! 16Ko
128 Mo !!     4      !!     1      !! 16M x 16 bits !!  8Ko
256 Mo !!     8      !!     2      !! 16M x 8 bits  !! 16Ko
256 Mo !!     4      !!     2      !! 16M x 16 bits !!  8Ko
256 Mo !!     8      !!     1      !! 32M x 8 bits  !! 16Ko
512 Mo !!     8      !!     2      !! 32M x 8 bits  !! 16Ko
512 Mo !!     4      !!     2      !! 32M x 16 bits !! 16Ko
!hline
!end_table

LES DIMMs SDRAM NON SUPPORTEES PAR LA CT60 :

!begin_itemize

!item Tous les mod‚les OBSOLETES : DIMMs 8Mo, 16Mo & 32 Mo.

!item Toutes les DIMMs avec des puces de 2 banks logiques = obsol‚tes 
(besoin de chips avec 4 banks). 

!item Toutes les DIMMs 'REGISTERED / BUFFURED' (g‚n‚rallement pour 
Stations et Serveurs, pas pour PC grand public). 

!item Les barettes 512 Mo ayant des puces uniquement sur une face. 

!end_itemize 

 
!node Montage

!subnode CT60

La CT60 est PLUG'N PLAY !

Regardez sur http://www.czuba-tech.com pour les informations.


!subnode Horloge CT60-100

Pour obtenir une meilleure horloge et supprimer les plantages … 100 MHz, 
vous avez besoin de cette modification :

A la gauche de l'oscillateur 100 MHz, se trouve IC3, un CY2309.

Ce circuit int‚gr‚ possŠde une PLL (boucle … verrouillage de phase), il 
est possible d'utiliser cette partie du circuit pour obtenir une 
meilleure horloge.

La pin 9 est connect‚e … la masse, couper cette pin.

!begin_verbatim

  | | | | | | | | |        +------+
 +-----------------+       |      |
 |8               1|       |100MHz|
 |   CY2309       (        |      |
 |9              16|       | OSC  |
 +------------------       |      |
  X | | | | | | | |        +------+

  ^
  |
  
 ici
!end_verbatim



!subnode G‚n‚rateur d'horloge programmable

Il y a deux solutions pour installer un g‚n‚rateur d'horloge programmable 
sur la CT60 :

!begin_itemize

!item La premiŠre, plus pr‚cise, utilise un module allemand ak-modul-bus 
avec un circuit Cypress CY27EE16 (r‚f‚rence … quartz et boucle … 
verrouillage de phase PLL).

!item La seconde, moins chŠre et plus petite, utilise le module CTCM avec 
un circuit Dallas DS1085Z-50 (oscillateur command‚ en tension VCO).

!end_itemize


!subsubnode Le module ak-modul-bus avec un CY27EE16

Il est possible d'ajouter un g‚n‚rateur d'horloge programmable par pas de 
125 KHz sur la CT60. Le module utilise un CY27EE16 connect‚ sur le support 
de l'oscillateur et deux signaux I2C du module SDRAM SDA (82) et SLC (83) 
trouv‚s sur R11 / R12. 

Parce que le module a besoin d'un support DIL24 et l'horloge CT60 a un 
support DIL14, vous pouvez utiliser quelques fils pour connecter le module 
… la CT60 comme ceci : 

!image ..\img\pclock.img
!begin_verbatim

!end_verbatim

(!U)
ATTENTION !
(!u)

Si vous ne vous sentez pas capable de souder deux fils trŠs fins sur R11 
et R12, retournez la CT60 et soudez les deux fils sur les pins 82 et 83 du 
support SDRAM (face avant … droite). Rodolphe suggŠre de passer par les 
pins du support DIL14 soit 2 (SCL vers la pin 83 du support SDRAM) et 3 
(SDA vers la pin 82 du support SDRAM) afin de pouvoir d‚monter l'ensemble 
facilement.

!image ..\img\dimm168p.img

!image ..\img\ct60_clk.img
!begin_verbatim

!end_verbatim

Reduisez la liaison CLK au minimum, le mieux est de mettre le sommet du 
module (pins 18 … 24) sur le support horloge de la CT60 (pins 8 … 14) via 
un prolongateur. 
Vous devez au minimum couper les pins 21/23 sur le sommet du module, autrement 
il y a un court circuit avec le signal CLK et le 3V3 de la CT60. 

!begin_verbatim

  +------------------------------------------+
  |                                        +5V 3V3   CLK      CLK
  |                                        14o__o__o__o__o__o__o
  |                 +------------------------------------------'8
 +5V   CLK6  CLK5  CLK4  GND   GND           |                 |
  o__o__o__o__o__o__o__o__o__o__o__o_____     )  Horloge CT60  |
24| GND   GND   GND   GND   GND   GND    |   |      support    |
  |                                 |o  o|  1|                 |7
  |                                 |o  o|   o--o--o--o--o--o--o
   )            Module              |o  o|           GND      GND
  |        avec un CY27EE16         |o  o|                     |
  |                                 |o  o|                     |
 1| GND   GND   GND   GND   GND   GND    |                     |
  o--o--o--o--o--o--o--o--o--o--o--o-----                      |
+3V3   CLK1  CLK2  CLK3  SCL   SDA +---------------------------+
                         |     |
                         |     |
                         v     v
                        R12   R11 (ou pin 82 du support SDRAM)
            (ou pin 83 du support SDRAM)
!end_verbatim

(!B)
Synoptique
(!b)
!image ..\img\cy_clock.img
!begin_verbatim

!end_verbatim

!begin_itemize

!item La sortie horloge CT60 programmable est CLK1 ou CLK4.

!item CLK2 et CLK 3 sont inhib‚s.
 
!item CLK5 et CLK6 peuvent ˆtre utilis‚s pour une horloge utilisateur, 
mais il y a toujours un lien avec l'horloge CT60 avec un diviseur de 2 
… 6 except‚ pour une fr‚quence <= 66 MHz : 

!end_itemize

!begin_table [|c|c|c|] !hline
Horloge CT60 (MHz) !! CLK5/6 (MHz) !! Diviseur
!hline
      50.000       !!   25.000     !!  /2
      66.000       !!   33.000     !!  /2
!hline         
      66.600       !!   16.650     !!  /4
      66.000       !!   33.000     !!  /2
      99.000       !!   33.000     !!  /3
!hline
!end_table

Le TOS contr“le si le module existe et peut changer l'horloge entre 50 et 
110 MHz (voir la partie 'Changer la fr‚quence de la CT60').

Regardez sur http://www.ak-modul-bus.de pour plus d'informations au sujet 
du module. 

(!B)
Sch‚ma
(!b)
!image ..\img\sc_clock.img
!begin_verbatim

!end_verbatim

(!B)
Liste des composants :
(!b)

!begin_verbatim
1 x CY27EE16FZEC.
1 x LM317LZ.
2 x Zener 4V7/500mW.
1 x Quartz 10 MHz.
1 x 180 ohms.
1 x 110 ohms.
2 x 4.7 Kohms.
3 x 100 nF.
1 x connecteur mƒle HE10 (ou HE14) 2x5.

1 x connecteur femelle HE10 2x5.
1 x cable plat 10 fils.
1 x female SUBD 9 contacts femelle.
!end_verbatim

(!B)
Note :
(!b)
Pour des fr‚quences vers 100 MHz, il faut modifier pour am‚liorer 
l'horloge de la CT60 (voir la partie 'Horloge CT60-100').


!subsubnode Le module CTCM avec un DS1085Z-50

Il est possible d'ajouter un g‚n‚rateur d'horloge programmable par pas de 
50 KHz sur la CT60. Le module CTCM utilise un DS1085Z-50 connect‚ sur le 
support de l'oscillateur et deux signaux I2C du module SDRAM SDA (82) et 
SLC (83).

!image ..\img\dimm168p.img

!image ..\img\ct60_clk.img

(!U)
ATTENTION !
(!u)

Le module CTCM utilise les pins non utilis‚s du support DIL14 soit 2 SCL 
vers la pin 83 du support SDRAM, et 3 SDA vers la pin 82 du support SDRAM, 
afin de pouvoir d‚monter l'ensemble facilement. Souder deux fils trŠs fins.
 
!image ..\img\ctcm.img

!begin_verbatim

               +-------------+
               |            +5V      CLK      CLK
               |           14o__o__o__o__o__o__o
               |        +-------------'        |8
               |        |    |                 |
               |        |     )  Horloge CT60  |
   ____________o__o__o__o_   |      support    |
  |pont       +5V      OUT  1|SCL SDA          |7
  |  X                  0|   o--o--o--o--o--o--o
  |       Module  +-------------+  | GND      GND
  |        CTCM   |      |         |  |
  |               |  +-------------+  |
  +---------------o--o--o-GND         |
                SCL SDA +-------------+
!end_verbatim

(!B)
Synoptique
(!b)
!image ..\img\ds_clock.img
!begin_verbatim

!end_verbatim

!begin_itemize

!item La sortie horloge CT60 programmable est OUT0. Si l'entr‚e CTRL0 est 
… 1 la plage va de 33 … 66 MHz (pont coup‚). Si l'entr‚e CTRL0 est … 0 la 
plage va de 66 … 110 MHz (pont mis).

(!B)ATTENTION ! Le boot 2.0 ne supporte plus le pont parceque l'horloge de 
la CTCM n'est pas stable (pas de PLL) et qu'il n'est pas possible de tester 
l'‚tat du pont.(!b) Aussi la plage de fr‚quence est de 66 … 110 MHz (le 
DALLAS utilis‚ sur la CTCM n'est pas certifi‚ pour fonctionner en dessous 
de 66 MHz).

!item OUT1 peut ˆtre utilis‚ pour unde horloge utilisateur, mais il y a 
toujours un lien avec l'horloge CT60 avec un diviseur de 2 … 6 except‚ pour
une fr‚quence <= 66 MHz : 

!end_itemize

!begin_table [|c|c|c|] !hline
Horloge CT60 (MHz) !! OUT1 (MHz) !! Diviseur
!hline
      66.000       !!   33.000   !!  /2
!hline         
      66.600       !!   16.650   !!  /4
      66.000       !!   33.000   !!  /2
      99.000       !!   33.000   !!  /3     
!hline
!end_table

(!B)
Note :
(!b)
Cette possibilit‚ est inhib‚ sur le module CTCM parceque la pin CTRL1 
est … 1 (connect‚e au +5V).

Le TOS contr“le si le module existe et peut changer l'horloge entre 33 et 
66 MHz ou 66 et 110 MHz suivant le pont sur le module (voir la partie 
'Changer la fr‚quence de la CT60'). 

Regardez sur http://www.czuba-tech.com pour plus d'informations au sujet 
du module. 

(!B)
Note :
(!b)
Pour des fr‚quences vers 100 MHz, il faut modifier pour am‚liorer 
l'horloge de la CT60 (voir la partie 'Horloge CT60-100').


!node Le TOS en Flash

!subnode Technique

C'est un TOS 4.04 patch‚ par le boot (2.0+), dans l'ordre il contient :

!begin_itemize
!item Le passage en mode superscalaire du 68060 (PCR).
!item L'initialisation des registres de translation (tous modŠles de 
68060), la zone m‚moire de 0 … $7FFFFFFF en copyback except‚ pour la 
zone de 0 … $FFFFFF en writethrough, et la zone de $40000000 … $FFFFFFFF 
en cache inhib‚.
!item La lecture et l'affichage du type de SDRAM via sa EEPROM. 
!item La copie du TOS en SDRAM aprŠs avoir appliqu‚ les patches.
!item L'initialisation de l'arbre PMMU. Toute la ST-RAM est en writethrough 
et la SDRAM d‚clar‚e en copyback.
!item L'installation des cookies '_CPU', '_FPU', 'CT60', mais aussi '_FRQ' 
(horloge interne) et 'FRE' (horloge externe) si le videl a besoin d'une 
horloge externe 32 MHz pour les moniteurs RVB. Le cookie CT60 peut 
retourner la fr‚quence de rotation d'un ventilateur via IO3 du MFP 
!item Les patchs du cache, de la PMMU, des adresses en $00FFxxxx, le 
remplacement des instructions movep.
!item Le detournement des exceptions pour l'affichage en clair d'un 
plantage.
!item L'‚mulation des instructions manquantes (entiers et FPU).
!item Les fonctions XBIOS CT60 de $C60A … $C60D (temp‚rature, 
paramŠtres en Flash, cache...), et du DSP (fonctions avec handshake).
!item Les patches n‚cessaires pour le blitter, les fontes systŠmes et le 
logo du boot sont copi‚s au sommet de la ST-RAM (indispensable si le TOS 
en ROM est un 4.02).
!item Le remplacement de la routine d'affichage de texte du BIOS.
!item Une image en 65K couleurs affich‚e pendant 2 secondes.
!item Contr“le et correction du modecode obtenu de la NVM.
!item Contr“le et initialisation d'une horloge programmable s‚rielle (port I2C).
!item Lancement du PCI BIOS et des drivers (si drivers.hex est charg‚).
!item L'affichage du type de 68060 (r‚vision, masque et fr‚quence).
!item La modification du PCR pour les modŠles bugg‚s r‚vision 1.
!item La d‚claration de la SDRAM au TOS.
!item L'initialisation de la SDRAM, et l'affichage du nombre de Mo/S en 
‚criture.
!item La cr‚ation du buffer fastram et de son cookie '_FRB'.
!item La cr‚ation du buffer fastram ‚tendu et de son cookie 'XFRB'.
!item L'affichage complet des informations sur la barette SDRAM.
!item Le patch pour l'ordre de boot des disques IDE et SCSI (8 choix).
!item Possibilit‚s suppl‚mentaires du boot :
!begin_itemize
!item Proc‚dure d'identification du p‚riph‚rique pour les lecteurs SCSI 
et IDE, le boot attend si un disque amovible n'est pas prˆt.
!item Ajout gestion IDE esclave.
!item Ajout gestion CompactFlash.
!item Gestion du format combin‚ MSDOS/TOS (root et partition), cette 
possibilit‚ supporte la permuttation des octets exig‚e pour le format 
MSDOS et recherche un *.SYS pour charger le driver de disques. 
!item Test de vitesse pour les disques bootables.
!end_itemize
!item Le patch pour le menu de boot.
!item La redirection de l'affichage des programmes AUTO vers un fichier boot.log.
!item Le patch de la fonction Pexec pour le copyback (cpush aprŠs la 
relocation).
!item Les patchs blitter des fonctions VDI, vro_cpyfm, vr_trnfm, et 
vrt_cpyfm pour fonctionner en SDRAM (un buffer interm‚diaire en ST-RAM est  
utilis‚).
!item Les patchs AES pour changer le buffer de Newdesk de 4 Ko … 32 Ko.
!item Support des scan-codes de la carte Eiffel :
!begin_itemize
!item PAGE HAUT/BAS.
!item IMPR ECRAN.
!item POWER (jeu 2 seulement, Eiffel 1.0.5).
!item VOLUME HAUT/BAS (jeu 2 seulement, Eiffel 1.0.5).
!end_itemize
!end_itemize 

!subnode Menu de d‚marrage

Le TOS peut remplacer magxboot (MagiC) ou ataboot (Linux) dans le dossier
AUTO pour un d‚marrage rapide (pas de programmes dans le dossier AUTO … 
d‚marrer). Vous pouvez activer le menu de d‚marrage avec le CPX de 
configuration. Ce menu est activ‚ si la s‚lection de l'OS pr‚f‚r‚ est 
differente de '-'. 

Vous pouvez choisir entre TOS, MagiC ou Linux, la valeur est sauv‚e sans 
la NVM.

!begin_itemize
!item Avec MagiC, le TOS essai de trouver le fichier MAGIC.RAM dans la 
racine du disque de d‚marrage. 
!item Avec Linux, le TOS essai de trouver le fichier BOOTARGS dans la 
racine du disque de d‚marrage. Essay‚ avec le moyau Linux 2.4.25. 
!end_itemize

Certes, vous pouvez toujours utiliser MAGXBOOT.PRG ou ATABOOT.PRG dans le 
dossier AUTO.

(!U)
ATTENTION !
(!u)

Sous le mode 030, replacez le mode sur '-'.


!subsubnode Bootargs extension (Linux)

Il y a une nouvelle option pour Linux et le fichier bootargs :

-V <valeur>: Modecode vid‚o ‚tendu.

Valeur est en d‚cimal ou en format C hexadecimal (0x).

Parceque la ligne de commande du noyau possŠde la fonctionalit‚ 
video=atafb:keep, lors du d‚marrage du systŠme il est pr‚f‚rable 
d'obtenir des meilleurs modes vid‚o.

Voici le detail de ce (!B) modecode (!b) ‚tendu :

!begin_table [|c|l|r|l|l|] !hline
Bit !! Nom        !! Valeur !! Commentaire              !! Exemples
!hline
    !!            !!    0x0 !! 1 plan, 2 couleurs       !!  
 0  !! BPS        !!    0x1 !! 2 plans, 4 couleurs      !!
 1  !!            !!    0x2 !! 4 plans, 16 couleurs     !!
    !!            !!    0x3 !! 8 plans, 256 couleurs    !!
 2  !!            !!    0x4 !! Near True Color 65K col. !!
!hline
 3  !! COL80      !!    0x8 !! double largeur           !!
!hline
 4  !! VGA_FALCON !!   0x10 !! indicateur VGA           !!
!hline
 5  !! PAL        !!   0x20 !! 50/60 Hz                 !!
!hline           
 6  !! OVERSCAN   !!   0x40 !! TV                       !! MONO: 768 x 560
!hline   
    !!            !!        !! 320 x 200 16 couleurs    !!
 7  !! STMODES    !!   0x80 !! 640 x 200 4 couleurs     !! 640 x 400 65K c 50MHz
    !!            !!        !! 640 x 400 2 couleurs     !! (BPS = 4)
!hline              
 8  !! VERTFLAG   !!  0x100 !! double ligne / entrelac‚ !! MONO: int. 896 x 1120
!hline
 9  !! HORFLAG    !!  0x200 !! double largeur           !! TV: 1280 x 640 or
    !!            !!        !!                          !! 1536 x 560 OVERSCAN
!hline
    !!            !!        !!                          !! TV: 960 x 640 (x1.5)
 10 !! HORFLAG2   !!  0x400 !! largeur augment‚e        !! VGA: 896x480/608/768
    !!            !!        !!                          !! MONO: 896 x 560 
!hline
 11 !!  VESA      !!  0x800 !! SVGA 608 lignes          !! \ 1024 x 768
!hline            
 12 !! ULTRA_VGA  !! 0x1000 !! SVGA 768 lignes          !! / VESA & ULTRA_VGA
!hline
!end_table

(!U)
SVGA liste en 16 couleurs :
(!u)

(modecode 16 coul., largeur x hauteur, fr‚q. vert., fr‚q. horiz., horloge)

!begin_verbatim
0x0112, 320 x 240, 60Hz, 31KHz, 25MHz (horloge interne)
0x0012, 320 x 480, 60Hz, 31KHz, 25MHz (horloge interne)
0x011A, 640 x 240, 60Hz, 31KHz, 25MHz (horloge interne)
0x001A, 640 x 480, 60Hz, 31KHz, 25MHz (horloge interne)
 
0x0512, 448 x 240, 60Hz, 31KHz, 32/36/38/40MHz (horloge interne/externe)
0x0412, 448 x 480, 60Hz, 31KHz, 32/36/38/40MHz (horloge interne/externe)
0x051A, 896 x 240, 60Hz, 31KHz, 32/36/38/40MHz (horloge interne/externe)
0x041A, 896 x 480, 60Hz, 31KHz, 32/36/38/40MHz (horloge interne/externe)

0x0912, 384 x 304, 57Hz, 35KHz, 32/36/38/40MHz (horloge interne/externe)
0x0812, 384 x 608, 57Hz, 35KHz, 32/36/38/40MHz (horloge interne/externe)
0x091A, 768 x 304, 57Hz, 35KHz, 32/36/38/40MHz (horloge interne/externe)
0x081A, 768 x 608, 57Hz, 35KHz, 32/36/38/40MHz (horloge interne/externe)

0x0D12, 448 x 304, 56Hz, 34KHz, 38/40MHz (horloge interne/externe)
0x0C12, 448 x 608, 56Hz, 34KHz, 38/40MHz (horloge interne/externe)
0x0D1A, 896 x 304, 56Hz, 34KHz, 38/40MHz (horloge interne/externe)
0x0C1A, 896 x 608, 56Hz, 34KHz, 38/40MHz (horloge interne/externe)
 
0x1112, 384 x 384, 86Hz, 34KHz, 32/36/38/40MHz (horloge int/ext, entrelac‚)
0x1012, 384 x 768, 86Hz, 34KHz, 32/36/38/40MHz (horloge int/ext, entrelac‚)
0x111A, 768 x 384, 86Hz, 34KHz, 32/36/38/40MHz (horloge int/ext, entrelac‚)
0x101A, 768 x 768, 86Hz, 34KHz, 32/36/38/40MHz (horloge int/ext, entrelac‚)     
0x1112, 384 x 384, 60Hz, 49KHz, 50MHz (horloge interne, non entrelac‚)
0x1012, 384 x 768, 60Hz, 49KHz, 50MHz (horloge interne, non entrelac‚)
0x111A, 768 x 384, 60Hz, 49KHz, 50MHz (horloge interne, non entrelac‚)
0x101A, 768 x 768, 60Hz, 49KHz, 50MHz (horloge interne, non entrelac‚) 
 
0x1512, 448 x 384, 87Hz, 34KHz, 38/40MHz (horloge int/ext, entrelac‚)
0x1412, 448 x 768, 87Hz, 34KHz, 38/40MHz (horloge int/ext, entrelac‚)
0x151A, 896 x 384, 87Hz, 34KHz, 38/40MHz (horloge int/ext, entrelac‚)
0x141A, 896 x 768, 87Hz, 34KHz, 38/40MHz (horloge int/ext, entrelac‚)
0x1512, 448 x 384, 54Hz, 44KHz, 50MHz (horloge interne, non entrelac‚)
0x1412, 448 x 768, 54Hz, 44KHz, 50MHz (horloge interne, non entrelac‚)
0x151A, 896 x 384, 54Hz, 44KHz, 50MHz (horloge interne, non entrelac‚)
0x141A, 896 x 768, 54Hz, 44KHz, 50MHz (horloge interne, non entrelac‚)
 
0x1912, 512 x 384, 78Hz, 31KHz, 38/40MHz (horloge int/ext, entrelac‚)
0x1812, 512 x 768, 78Hz, 31KHz, 38/40MHz (horloge int/ext, entrelac‚)
0x191A,1024 x 384, 78Hz, 31KHz, 38/40MHz (horloge int/ext, entrelac‚)
0x181A,1024 x 768, 78Hz, 31KHz, 38/40MHz (horloge int/ext, entrelac‚)
Mode exp‚rimental … cause des limitations avec la bande passante de la 
ST-RAM, le mode 256 couleurs ne fonctionne pas, mais le mode 16 couleurs 
normalement ne pose pas de problŠmes :
0x1912, 512 x 384, 56Hz, 46KHz, 60MHz (non entrelac‚, horloge int. 50 MHz)
0x1812, 512 x 768, 56Hz, 46KHz, 60MHz (non entrelac‚, horloge int. 50 MHz)
0x191A,1024 x 384, 56Hz, 46KHz, 60MHz (non entrelac‚, horloge int. 50 MHz)
0x181A,1024 x 768, 56Hz, 46KHz, 60MHz (non entrelac‚, horloge int. 50 MHz)
!end_verbatim

Par exemple, avec -V 0x141A (format hexa), vous obtenez 896 x 768 16 
couleurs : BPS=2, COL80, VGA_FALCON, HORFLAG2, ULTRA_VGA

Vous devez utiliser COL80 with 2 couleurs.
Il n'est pas possible d'avoir 65K couleurs avec COL80.

(!U)
Mise en garde 
(!u)

!begin_verbatim
CETTE POSSIBILITE EST ABSOLUMENT SANS GARANTIE !
CECI PEUT FACILEMENT DETRUIRE VOTRE MONITEUR SVGA !
SI VOUS VOUS ENGAGEZ, C'EST A VOTRE PROPRE RISQUE !
SINON UTILISEZ -V.
!end_verbatim

Si les Radeon/CTPCI sont utilis‚s, il est possible d'‚viter que le kernel 
utilise le Videl, par exemple avec bootargs :

-V 0x4303 -k vmlinuz root=/dev/hda9 video=atafb:external:1920;1080;8;p;0x40000000 

0x4303 ‚tant le modecode pour le driver Radeon (Vsetscreen) utilis‚ dans Ataboot.
external servant … passer les infos au kernel (0x40000000 ‚tant l'adresse de l'‚cran,
'p' pour packed pixels, 't' pour true color).


!subnode Reconnaissance SDRAM

Le TOS vient chercher les informations dans la EEPROM de la SDRAM afin de 
configurer le controleur m‚moire (SDR60). En cas d'erreur (voir le 
chapitre SDRAM pour les types reconnus) il suffit d'appuyer sur une touche 
pour lister les 'Informations sur la SDRAM'.


!subnode Test SDRAM

Si la lecture et l'affichage du type de SDRAM via sa EEPROM est correcte 
mais par exemple si le logo du TOS n'apparait pas, peut-ˆtre que la SDRAM 
est d‚fectueuse ou non adapt‚e pour la CT60.

Pour tester la SDRAM :

!begin_itemize
!item En mode normal et avec le CPX de configuration de la CT60, r‚glez le 
d‚lais au boot … 60 secondes.
!item Eteignez la machine.
!item Basculer en mode turbo.
!item Remettez sous tension le FALCON.
!item AprŠs l'initialisation de la SDRAM (… 0), commence le test ST-RAM 
puis celui de la TT-RAM (la SDRAM ici), si a la place des '-' vous voyez 
des 'X', la SDRAM est d‚fectueuse.
!end_itemize

Pour connaitre les 'Informations sur la SDRAM' :

Pendant que logo Atari du boot apparait, appuyez sur la touche SHIFT 
droit.


!node Diagnostiques Atari

La deuxiŠme partie de la Flash (en $00ED0000-$00EEFFFF) contient les 
Diagnostiques Atari mis … jour pour la CT60 (ajout SDRAM et corrections 
68060). Le clavier Azerty est ‚galement g‚r‚.

CTRL-ALT-SHIFTL-SHIFTL lance les Diagnostiques Atari si il est appuy‚ 
avant le logo Atari.  

(!U)
ATTENTION !
(!u)

(!U)
La fin anormale de ces tests entraine une perte de donn‚es :
(!u)

!begin_itemize
!item RTC/NVRAM.
!item IDE.
!item SCSI.
!end_itemize

(!U)
Si vous avez une CTPCI at que vous avez charg‚ drivers.hex, les diagnostiques
ne sont plus disponibles.
(!u)


!subnode Principales Touches

!begin_verbatim
 R : SDRAM, ST-RAM et DSP SRAM.
 O : O.S. ROM.
 M : MIDI.
 S : SCC Serie.
 T : D‚lais MFP.
 D : SDMA / Port DSP.
 F : Lecteur de Disquettes.
 P : Imprimante / Manettes.
 L : Horloge Temps R‚el / NVRAM.
 G : Test Blitter court.
 I : Port SCSI.
 X : Bus d'Extension.

 A : Audio.
 V : Vid‚o.
 K : Clavier.
 Y : Lecteur de Disquettes (Protection en Ecriture).
 H : Disque Dur IDE.

 E : Examine / Modifie SystŠme.
 ? : Aide.
 $ : Version / Date.
 UNDO : Lancer le TOS.
 
 D : Menu Diagnostiques.
 E : Rapport d'Erreurs.
 > : Forcer Etat Bon.

 P : Pr‚ 'Chauffage'.
 B : 'Chauffage'.
 F : AprŠs 'Chauffage'.
 I : Processus d'Assemblage.
 U : Unit‚s Assembl‚s.
 W : Effacer Status et Recommencer.
!end_verbatim


!subnode Aide

La s‚lection d'un simple test ou une combinaison de tests se fait en 
tapant la ou les lettre(s) correspondante(s), et ensuite RETURN. Pour 
lancer en r‚p‚tition de cycles d'un ou des test(s), faire suivre la 
derniŠre lettre avec le nombre de cycles … lancer. Par exemple, "RSM25", 
va lancer les tests RAM, Serie, MIDI 25 fois. Si 0 est ajout‚, le test se 
fait en continu. 

La touche ESC sert pour quitter le cycle. Dans certain cas il peut y avoir 
un d‚lais avant d'avoir la main au clavier.

Un terminal RS232 peut ˆtre utilis‚ pour l'affichage et la saisie. Le test 
s‚rie RS232 ne fonctione pas si un terminal est install‚ … la place du 
bouclage du port sur la connecteur.

Normallement un moniteur couleur est utilis‚ pour tous les tests except‚ 
la haute r‚solution. Si une erreur survient, un message d'erreur est 
affich‚ et l'‚cran passe au rouge. Quand le test est fini, 'Pass' (Bon) ou 
'Fail' (Mauvais) apparait, et l'‚cran doit passer au vert ou au rouge.

Si de multiples tests tournent et une erreur survient sur un test, 
l'ecran va rester au rouge, mˆme aprŠs une succession de tests exc‚cut‚s 
correctement. Une fois le test arrˆt‚, la BARRE d'ESPACE est utilis‚e pour 
retourner au menu.

Les tests DMA et Imprimante / manettes demandent un accessoire … attacher.

Le test O.S. ROM calculate un checksum/CRC des ROMs et compare le 
r‚sultat CRC avec la valeur trouv‚e dans les ROMs.

Si le test RAM sort en erreur, le code d'erreur, l'addresse, la donn‚e
‚crite, la donn‚e lue et les bits mauvais (0-15) sont affich‚s.

Le court test Blitter n'affiche rien sur l'‚cran. Le long test Blitter, 
tant que n'apparait pas la fin du rectangle, est bon.

(!B)
TESTS OPERATEUR DEMANDE
(!b)

Les tests Audio, Vid‚o, Clavier, et Disque Dur IDE ont quelques messages 
d'erreur. L'op‚rateur doit d‚terminer si les r‚sultats visibles sont 
acceptables. 

Le test Gen/lock est lanc‚ deux fois. Basculer l'interrupteur sur le 
gen/lock incorpor‚ devrait basculer entre le mode normal avec menu et sans 
menu. En cas d'abscence de menu un cycle de "balayage" devrait battre.  
Faure un Reset de l'ordinateur avec chaque changement de l'interrupteur 
gen/lock.  

NOTE - LANCER CE TEST SEULEMENT AVEC UN MONITEUR COULEUR.


!subnode Error Codes Quick Reference (Anglais)

From the 

(!B)
Falcon 030 Production Diagnostic Manual
(c) 1992, Atari Microsystems
(!b)

This is a brief summary of all error codes which may occur when running 
the diagnostic.


!subsubnode Initialisation (Errors occuring before the title and menu appear)

!begin_verbatim
I1 RAM data line is stuck.
I2 RAM disturbance. Location is altered by write to another location.
I3 RAM addresing. Wrong location is being addressed.
I4 MMU chip error. No DTACK after RAM access.
I5 RAM sizing error. Uppermost address fails.
I6 Bus Error handling failed. Bus Error occured (on purpose), but caused a 
   crash (e.g. system was unable to read the vector from RAM).
I7 Bus Error not detected. COMBEL not asserting Bus Error or the signal is 
   not reaching the 680xx.
!end_verbatim


!subsubnode Exceptions (may occur at any time)

!begin_verbatim
E1-E5 Not used.
E6    Autovector error. IPL0 is grounded or 680xx is bad.
E7    Spurious interrupt. Bus error during exception processing. Device 
      interrupted, but did not provide interrupt vector.
E8    Internal Exception (generated by 680xx).
E9    Bad Instruction Fetch.
EA    Address error. Tried to read an instruction from an odd address. 
EB    Bus Error (Access Fault on a 68060). Generated internally by the 
      680xx or externally by COMBEL. Usually caused by device not 
      responding. Displays the address of the device being accessed.
!end_verbatim


!subsubnode SRAM (DSP), ST-RAM and SDRAM

!begin_verbatim
R0   Low memory failed while setting up to run test.
R1   Failed walking 1s or 0s.
R2   Failed address (counting pattern).
R3   Failed 64K boundary test. Probable failure in Memory Controller.
R4   Failed while displaying area tested (video RAM).
DSP4 SRAM Test Timeout; test started but never completed.
DSP5 SRAM Failure; RAM failure during SRAM test.
!end_verbatim


!subsubnode MIDI

!begin_verbatim
M0 Data not received. Indicates a broken data path.
M1 Write/Read data mismatch. The data written was not the same as the data 
   read.
M2 Input frame error. Noisy signal.
M3 Input parity error. Noisy signal.
M4 Input data overrun. The 6850 received a byte before the previous byte 
   was read. The MFP may not be responding to the interrupt request.
!end_verbatim


!subsubnode Serial Ports

(!B)
Port A Errors:
(!b)

!begin_verbatim
SCC A internal loopback: Transmitter time-out Transmitter failed.
SCC A internal loopback: Receiver time-out    Receiver failed.
SCC A internal loopback: Overrun              A byte was received before 
                                              the CPU read the previous 
                                              byte.
SCC A internal loopback: Framing error        Incorrect time between start 
                                              and stop bits.
SCC A internal loopback: Parity error         Input data had incorrect 
                                              parity.
SCC A internal loopback: Data compare         Data read was not what was
                                              sent.
Port A has no loopback connector              The loopback connector is 
                                              not installed on a Port A.
LAN has no loopback connector                 The loopback connector is 
                                              not installed on the LAN 
                                              port.
LAN ERROR: DCD IS ACTIVE WITHOUT              The carrier detect signal is 
RTS ON                                        active without a request to 
                                              send.
LAN ERROR: RTS IS ACTIVE BUT DCD IS           The request to send signal is 
NOT RESPONDING                                on but no carrier is active.
Port A async mode: Transmitter time-out       Transmitter failed.
Port A async mode: Receiver time-out          Receiver failed.
Port A async mode: Overrun                    A byte was received before 
                                              the CPU read the previous 
                                              byte.
Port A async mode: Framing error              Incorrect time between 
                                              start and stop bits.
Port A async mode: Parity error               Input data had incorrect 
                                              parity.
Port A async mode: Data compare               Data read was not what was 
                                              sent.
Port A modem control error: DTR-DCD           Signal sent at DTR is not 
                                              detected at DCD.
Port A modem control error: DTR-DSR           Signal sent at DTR is not 
                                              detected at DSR.
Port A modem control error: RTS-CTS           Signal sent at RTS is not 
                                              detected at CTS.
!end_verbatim

(!B)
Port B Errors:
(!b)

!begin_verbatim
SCC B internal loopback: Transmitter time-out Transmitter failed.
SCC B internal loopback: Receiver time-out    Receiver failed.
SCC B internal loopback: Overrun              A byte was received before 
                                              the CPU read the previous 
                                              byte.
SCC B internal loopback: Framing error        Incorrect time between start 
                                              and stop bits.
SCC B internal loopback: Parity error         Input data had incorrect 
                                              parity.
SCC B internal loopback: Data compare         Data read was not what was
                                              sent.
Port B has no loopback connector              The loopback connector is 
                                              not installed on a Port A.
LAN has no loopback connector                 The loopback connector is 
                                              not installed on the LAN 
                                              port.
LAN ERROR: DCD IS ACTIVE WITHOUT              The carrier detect signal is 
RTS ON                                        active without a request to 
                                              send.
LAN ERROR: RTS IS ACTIVE BUT DCD IS           The request to send signal is 
NOT RESPONDING                                on but no carrier is active.
Port B async mode: Transmitter time-out       Transmitter failed.
Port B async mode: Receiver time-out          Receiver failed.
Port B async mode: Overrun                    A byte was received before 
                                              the CPU read the previous 
                                              byte.
Port B async mode: Framing error              Incorrect time between 
                                              start and stop bits.
Port B async mode: Parity error               Input data had incorrect 
                                              parity.
Port B async mode: Data compare               Data read was not what was 
                                              sent.
Port B modem control error: DTR-DCD           Signal sent at DTR is not 
                                              detected at DCD.
Port B modem control error: DTR-DSR           Signal sent at DTR is not 
                                              detected at DSR.
Port B modem control error: RTS-CTS           Signal sent at RTS is not 
                                              detected at CTS.
!end_verbatim


!subsubnode SCC Interrupt Errors

!begin_verbatim
SCC interrupt error: Transmitter time-out  Transmitter failed.
SCC interrupt error: Receiver time-ou      Receiver failed.
SCC interrupt error: Overrun               A byte was received before the 
                                           CPU read the previous byte.
SCC interrupt error: Framing error         Incorrect time between start 
                                           and stop bits.
SCC interrupt error: Parity error          Input data had incorrect 
                                           parity.
SCC interrupt error: Data compare          Data read was not what was 
                                           sent.
No Tx interrupt                            A transmit command was issued 
                                           but no interrupt occured.
No Rx interrupt                            A receive command was issued 
                                           but no interrupt occured.
!end_verbatim


!subsubnode Timming

!begin_verbatim
T0 MFP Timer error. One or more of the four timers in the MFP did not 
   generate an interrupt on counting down.
T1 Vertical Sync. VIDEL is not generating vertical sync in the required 
   time period.
T2 Horizontal Sync. VIDEL is not generating horizontal sync in the 
   required time period.
T3 Display Enable. VIDEL is not generating DE output or the MFP is not 
   generating an interrupt.
T4 Video Counter Error. The COMPO IC is not generating the correct 
   addresses for the display. This will result in a broken-up display in 
   some or all display modes.
T5 PSG Bus Error. The PSG chip is defective.
T6 AJAX Bus Error. The AJAX chip is defective.
!end_verbatim


!subsubnode Blitter

!begin_verbatim
G1                    Halftone RAM (Internal RAM in BLiT portion of 
                      COMBEL).
G2                    Endmask.
G3                    Operation.
G4                    Halftone Op.
G5                    Skew.
G6                    Reverse Bit.
G7                    Force Extra Source Read.
G8                    Smudge.
G9                    X Count.
GA                    Y Count.
GB                    Time-out.
GC                    Address Count.
BUS ERROR during BLiT Replace COMBEL chip.
Test
!end_verbatim


!subsubnode Real-Time Clock

!begin_verbatim
C0 No real-Time Clock.
C1 Increment Error.
!end_verbatim


!subsubnode SCSI

!begin_verbatim
ERROR - SCSI STATUS CODE - XX      SCSI controller has reported error
                                   number XX. 
ERROR - CONNOT SELECT SCSI DISK    Cannot win arbitration for SCSI bus.
ERROR PRG MODE - READ AND WRITE    Data in the two RAM buffers are not
BUFFERS DO NOT COMPARE             the same.
ERROR DMA MODE - 5380 OR SCSI DISK An Attempt to poll the SCSI drive 
IS NOT RESPONDING                  failed.
ERROR DMA MODE - READ AND WRITE    Data in the two RAM buffers are not
BUFFERS DO NOT COMPARE             the same.
ERROR - DMA BLOCK MOVE TIME-OUT    DMA block move operation timed out.
ERROR - TIME-OUT SCSI BUS ALWAYS   Interrupt not seen by MFP.
BUSY
!end_verbatim


!subsubnode Keyboard

!begin_verbatim
K0 Stuck key. A key closure was detected while the keyboard self test was 
   executing.
K1 Keyboard not responding. A command was sent to the keyboard processor 
   and no status was returned within the allowed time.
K2 Keyboard status error. The selft test command was sent to the keyboard, 
   on completion of the test, the keyboard sent an error status.
!end_verbatim


!subsubnode IDE

!begin_verbatim
Read error on sector.
Write error on sector.
Data compare error (wrote, read, hex offset).
Controller not responding.
Operation timed-out.
Command error.
Status = XX.
DMA count error.
Error restoring data.
DMA address error - Data written outside data buffers.
Error on command access of disk.
Reading buffer.
Failed read of original data from disk.
Read buffer full - start next cycle.
Failed writing test data to disk.
Failed reading test data to disk.
!end_verbatim


!subsubnode Printer and Joystick Ports

!begin_verbatim
P0 Printer port error. Data read from the printer port was not what was 
   written.
P1 Busy interrupt error. The input to the MFP is not being read, or the 
   STROBE output from the PSG is not functioning, or Joystick 0 pin 3 not 
   connected.
J0 Joystick Port 0. The keyboard input is not functioning.
J1 Joystick Port 1. The keyboard input is not functioning.
J2 Joystick time-out. Joystick inputs were simulated by outputting data on 
   the printer port and routing it via the test fixture to the joystick 
   ports. Joysticks inputs are detected by the keyboard and sent to the CPU 
   via the 6850. This error can be caused by printer port failure (code 
   P0), keyboard failure, or keyboard-CPU communication line.
J3 Left button input. Not seen by the test keyboard.
J4 Right button input. Not seen by the test keyboard.
J5 Aux Joystick Direction. Game controller port (J500, J501) direction 
   bits. U511 is used to drive the input via test fixture. The hexadecimal 
   data following corresponds to bits read from latches U510 and U512, 
   where a one indicates an error. For example, 0002 indicates and erreur 
   at J500 pin 3.
J6 Aux Fire Button. Fire buttons are read from U509. Signal is driven via 
   the test fixture from the output of U511.
J7 Paddle. The inputs are driven by either 5V/100 ohms or 5V/1M on the 
   test fixture. This current charges the RC network on the FALCON030, 
   varying the output pulse of the LM556.
J8 Light gun. The light gun (XPEN) input is toggled at three points on the 
   screen (the video address counter is used to find the position of the 
   screen). The COMBEL should return the X/Y coordinates of the screen 
   position.
!end_verbatim


!subsubnode Floppy Disk Drive

!begin_verbatim
No floppy connected The controller cannot read index pulses. Indicates the 
                    cable may be improperly connected, or the drive has no 
                    power, or the drive is faulty.
F0                  Drive not selected. Drive was installed, but failed 
                    attempting restore (seek to track 0).
                    
The general error messages
"Error Wrinting" (or reading
or formatting), are combined
with a more specific error 
message, e.g., "F9 CRC error".

F4                  Seek error. Error occured during a seek.
F5                  Write protected. Indicates the floppy is write 
                    protected.
F6                  Read compare error. Data read from the disk was not 
                    what was supposed to be written.
F7                  DMA error. DMA Controller could not respond to a 
                    request for DMA.
F8                  DMA count error. Amount of bytes transferred is not 
                    correct.
F9                  CRC erreur. The floppy could not read a sector header.
FA                  Recorder not found. The floppy could not read a sector 
                    header.
FB                  Side select error - single sided drive. The test tried 
                    to write both sides of the diskette, but writing side 
                    1 caused side 0 to be overwritten.
FC                  Lost data. Data was transferred to the AJAX chip 
                    faster than the AJAX could transfer to the DMA 
                    Controller. 
FD                  Drive not ready. The format/write/read operation 
                    timed-out.
!end_verbatim


!subsubnode Expansion Port

!begin_verbatim
Spurious interrupt 5        A Spurious Interrupt was received on level 5.
                            Check MFP, COMBO, and Interrupt line 5.
Spurious interrupt 1        A Spurious Interrupt was received on level 1. 
                            Check MFP, COMBO, and Interrupt line 1.
Spurious interrupt 6        A Spurious Interrupt was received on level 6.   
                            Check MFP, COMBO, and Interrupt line 6.
Bus error from int level 6  A Bus Error was asserted while accessing 
                            Interrupt level 6. Check MFp, COMBO, and 
                            Interrupt line 6.
Bus error                   A Bus Error occurred during testing. Check 
                            COMBO. 
Spurious Interrupt          A Spurious Interrupt was received during 
                            testing. Check MFP, COMBO, and Interrupt 
                            lines. 
Address Error               An Address Error occurred during testing. Check 
                            COMBO, MC680xx, and all address lines for 
                            shorts or opens.
Halt Test failed            A halt operation failed to take place when 
                            programmed. Check COMBO, HALT line, and 
                            MC680xx.
500 KHz clock stuck low     The 500 KHz line is stuck. Check COMBO and 
                            clock line.
500 KHz clock stuck high    The 500 KHz line is stuck. Check COMBO and 
                            clock line.
Printer is not responding   The printer port did not respond to command. 
                            Check printer data line, SDMA, COMBO, and PSG.
Bus error signal stuck low  The Bus Error line is stuck. Check COMBO, and 
                            Bus Error line. 
Bus error signal stuck high The Bus Error line is stuck. Check COMBO, and 
                            Bus Error line.                    
Blitter test failed         Expansion Blitter test failed. Check COMBO, 
                            address lines, and data lines.
Expansion port is not       Expansion test fixture not installed. Check 
connected                   connection of Expansion Test Fixture.
Address Latch failed at     Address Latch failed. Check COMBO.
addr\exp\read:
Interrupt level 1 failed    Interrupt failed on level 1. Check MFP, COMBO, 
                            and Interrupt line 1.
Interrupt level 3 failed    Interrupt failed on level 3. Check MFP, COMBO, 
                            and Interrupt line 3.
Interrupt level 5 failed    Interrupt failed on level 5. Check MFP, COMBO, 
                            and Interrupt line 5.
Interrupt level 6 failed    Interrupt failed on level 6. Check MFP, COMBO, 
                            and Interrupt line 6.
Interrupt priority failed   Interrupt priority test failed. Check MFP, 
                            COMBO, and Interrupt lines.
RAM failed addr.write.read: RAM test failed. Check COMBO and RAM address 
                            and data lines.
!end_verbatim


!subsubnode DSP Port Error Codes

!begin_verbatim
DSP0 - DSP Not Executing Program  DSP not responding.
DSP1 - SSI Test Timeout           Serial port timeout.
DSP2 - SSI Loopback Timeout       Data not completing loopback.
DSP3 - SSI Bad Data               Data mismatch after loopback.
!end_verbatim


!subsubnode EEPROM SDRAM

!begin_verbatim
EE SDRAM not found. SDRAM not connected.
EE SDRAM chip density error. This SDRAM not works on the CT60.
EE SDRAM number of banks error. This SDRAM not works on the CT60.
EE SDRAM density error. This SDRAM not works on the CT60.
EE SDRAM burst length error. This SDRAM not works on the CT60. 
EE SDRAM data width error. This SDRAM not works on the CT60.
EE SDRAM voltage error. This SDRAM not works on the CT60.
EE SDRAM type error. This SDRAM not works on the CT60.
EE SDRAM refresh rate error. This SDRAM not works on the CT60.
!end_verbatim


!node Flash Tool

!subnode Utilisation

!image ..\img\flash1.img
!begin_verbatim

!end_verbatim

La tache principale de ce programme est de mettre une image binaire du 
TOS (.BIN) ou des fichier Srecord (.HEX) dans la flash. Il est possible 
‚galement de mettre … jour la flash depuis le 68060 (mode turbo).

Depuis le BOOT v2.0, il est possible de charger s‚par‚ment les fichier pour le 
TOS404, le boot et les drivers PCI pour la CTPCI:
!begin_itemize
!item CT60TOS.BIN: contient BOOT + TOS404 + Atari Diagnostics (doit disparaitre).
!item BOOT.HEX: contient le BOOT.
!item DIAG.HEX: contient Atari Diagnostics.
!item DRIVERS.HEX: contient les drivers PCI (GPL licence, ‚crase DIAG.HEX).
!item TOS404.BIN (pas dans l'archive): juste pour mettre le TOS en flash, dans 
ce le cas ou CT60TOS.BIN n'est pas utilis‚.
!end_itemize

!image ..\img\flash2.img
!begin_verbatim

!end_verbatim

La deuxiŠme tache est de mettre … jour la partie hard de la CT60 avec les 
fichiers jedec (.JED) pour les composants ABE60, SDR60 et CTPCI (XILINX 
XC95144XL / XC95288XL CPLD).
Cette mise … jour V2.01 permet de programmer l'ETHERNAT (XC9572XL). 

!begin_itemize

!item Vous avez besoin de fabriquer un cable pour le connecteur JTAG CT60 
en liaison avec le port //, regardez 'Cable JTAG/parallŠle'. 

!item Normallement le cable doit ˆtre attach‚ et mis sous tension (par la 
CT60) pour une propre verification. Seulement le composant SDR60 peut  
ˆtre programm‚ (ou verifi‚) quand la CT60 est connect‚e … la carte 
mŠre en mode normal 030 (si vous utilisez la mˆme machine CT60/F030 
;-) ). Si vous mettez … jour le composant ABE60, vous devez enlever la 
CT60 du bus except‚ s'il y a une r‚sistance de 1Kohms entre le GND et 
l'une des 3 pins #1 des 74LVC245. Dans ce cas il faut que le blitter 
ne soit pas utilis‚ (NVDI install‚). 

!item Si vous chargez les bons fichiers jedec, un autre bouton apparait 
'verify'. Vous pouvez utiliser ce bouton pour comparer le fichier 
jedec avec le composant. Le bouton 'program' efface, programme, et 
verifie sa flash.
 
!end_itemize 


!subnode Connecteur JTAG CT60

Ce sont les pins du commecteur 'tower' non utilis‚s (vous voyez 'RESERVED' 
sur la carte) :

!begin_table [|c|l|l|] !hline
Pin Carte !! Signal   !! Pin cable JTAG/parallŠle
!hline
   12     !! JTAG_VCC !! 1
   13     !! JTAG_GND !! 2
   14     !! JTAG_KEY !! (pas de pin !)
   15     !! JTAG_TCK !! 3
   16     !! JTAG_TDO !! 4
   17     !! JTAG_TDI !! 5
   18     !! JTAG_TMS !! 6
!hline
!end_table

Pour information voici les autres pins de ce connecteur :

!begin_table [|c|l|l|] !hline
Pin Carte !! Signal   !! Commentaire
!hline
   1      !! PWR_SW+  !! Power Switch 
   2      !! PWR_SW-  !! 
   3      !! TRB_SW+  !! Turbo Switch
   4      !! TRB_SW-  !! 
   5      !! IDE_LED+ !! Led IDE
   6      !! IDE_LED- !!
   7      !! RST_SW+  !! Reset Switch
   8      !! RST_SW-  !! 
   9      !! PWR_LED+ !! Power led
   10     !! NC
   11     !! PWR_LED- !! 
!hline
!end_table


!subnode Cable JTAG/parallŠle

!image ..\img\schema.img
!begin_verbatim

!end_verbatim

Il faut imp‚rativement un 74HC125 ou 74AHC125 et non un 74HCT125 ou 
74AHCT125 car l'alimentation de cable via la CT60 est en 3,3V.


!node Configuration

!subnode Introduction

La configuration de la CT60 se fait avec un CPX de pr‚f‚rence utilis‚ avec 
XCONTROL, ZCONTROL, ou COPS.

Ce CPX permet de :

!begin_itemize
!item Configurer la M‚moire Non Volatile.
!item Configurer le boot en Flash Eprom.
!item Mesurer le nombre de MIPS.
!item Voir la charge du systŠme (MiNT ou MagiC seulement).
!item Mesurer la temp‚rature du 68060 (pour l'overclocking). => Avec le 
driver CT60XBIO.PRG ou le TOS en flash.
!item Eteindre l'ordinateur.
!item Voir les 'Informations sur la SDRAM'.
!end_itemize

!image cpx2.img
!begin_verbatim

!end_verbatim

Il y a 5 boutons communs sur ce CPX :

!begin_itemize
!item Sauve : Bouton pour sauver les r‚glages sur le disque.
!item Charge : Bouton pour charger les r‚glages sauv‚s sur le disque.
!item OK : Bouton pour valider les changements dans la m‚moire non 
volatile et les paramŠtres en flash. 
!item Annule: Bouton pour ne rien changer … la configuration.
!item i : Bouton pour afficher des informations (auteurs et SDRAM).
!end_itemize

Pour surveiller la temp‚rature, remonter les courbes, mesurer la charge 
CPU moyenne, arrˆter la machine, ou mettre en veille le moniteur 
(sous Radeon/CTPCI), le CPX :

!begin_itemize
!item Sous TOS cr‚e l'accessoire CT60TEMP.ACC et demande de rebooter.
!item Sous MiNT cr‚e l'application CT60TEMP.APP et la lance.
!item Sous MagiC lance un thread.
!end_itemize


!subnode Charge moyenne

!image cpx1.img
!begin_verbatim

!end_verbatim

Sur cette page vous pouvez voir pour MiNT et MagiC :

!begin_itemize
!item La valeur courante de la charge moyenne du microprocesseur.
!item Le niveau de charge moyenne du microprocesseur.
!item La courbe d'‚volution de la charge moyenne du microprocesseur durant 
la derniŠre heure. Sans MiNT 1.11 ou plus, cette courbe est trŠs approximative.
!end_itemize


!subnode Temp‚rature

!image cpx2.img
!begin_verbatim

!end_verbatim

Sur cette page vous pouver voir :

!begin_itemize
!item La valeur courante de la temp‚rature du 68060.
!item Le niveau de temp‚rature du 68060, Rouge = Danger. 
!item La courbe d'‚volution de la temp‚rature du 68060 durant la derniŠre 
heure. Cette courbe est verte ou jaune en temps normal et passe au rouge 
en cas de danger.
!item Eventuellement la courbe de temp‚rature de la tour durant la derniŠre 
heure si vous avez une carte Eiffel (avec le cookie 'Temp'). Cette courbe 
est normalement en bleu et passe en violet si le ventilateur de la tour 
est command‚ par la carte Eiffel. 
!end_itemize

Sur cette page vous pouvez changer :

!begin_itemize
!item Le seuil de d‚clenchement de l'alarme de temp‚rature.
!item Eventuellement le d‚calage du convertisseur analogique de la CT60 en 
double-cliquant sur ce seuil (offset TLV). 
!end_itemize

Remarques:

!begin_itemize
!item Sur CT63, le niveau de temp‚rature reste … 0 (pont‚ par Rodolphe).
!item Le seuil est sauv‚ dans le CPX avec le bouton 'Sauve' (et pas en NVRAM 
ou dans les paramŠtres en flash). La gestion est faite par CT60TEMP.ACC/APP.
!item Le d‚calage est ‚crit en NVRAM ou dans un paramŠtre en flash via 
le bouton 'OK'.
!end_itemize


!subnode M‚moire / uP

!image cpx3.img
!begin_verbatim

!end_verbatim

Sur cette page vous pouvez :
                                       
!begin_itemize

!item Voir la capacit‚ totale de la ST-Ram.

!item Voir la capacit‚ totale de la Fast-Ram.

!item Voir le Nombre d'octets de la ST-Ram libres.

!item Voir le Nombre d'octets de la Fast-Ram libres.

!item Voir le Nombre de millions d'instructions par seconde effectu‚s par 
le microprocesseur.

!item S‚lectionner avec/sans FPU.

!item Eventuellement changer la fr‚quence de la CT60.

!item Eventuellement changer la division de la fr‚quence utilisateur de 2 … 6. 

!item Eventuellement voir la vitesse du ventilateur ou de la pompe (si 
watercooling) avec de la connectique 3 fils :

!end_itemize

!begin_verbatim
                           1N4148
     * Jaune ---<47 ohms>---|<|---> IO3 MFP pin 28
     * Rouge ---------------------> +12V CT60 connecteur ventilateur
     * Noir  --------------------->  GND CT60 connecteur ventilateur
!end_verbatim


!subsubnode Changer la fr‚quence de la CT60

Avec le curseur de la page 'M‚moire / uP' du CPX de configuration, il est 
‚ventuellement possible de changer la fr‚quence de la CT60.

Pour cela un module g‚n‚rateur d'horloge programmable utilisant un 
CY27EE16 ou un DALLAS DS1085Z-50 doit ˆtre connect‚ sur le port I2C de 
la CT60 via quelques fils (voir aussi pour plus d'informations la partie 
'G‚n‚rateur d'horloge programmable').  

Le r‚glage se fait par pas de 125 KHz de 50 … 110 MHz pour le CY27EE16 
(module ak-modul-bus), ou par pas de 50 KHz de 66 … 110 MHz pour le 
DS1085Z-50 (module CTCM), il est pris en compte en RAM pour essai aprŠs 
'OK'. Le TOS lors du boot pendant l'apparition du logo Atari envoi 
‚galement cette valeur … l'horloge mais en en cas de problŠme il est 
possible de rester sur la fr‚quence d'origine en appuyant CTRL ou ALT.

Une horloge utilisateur est disponible, c'est la fr‚quence de la CT60 divis‚e 
de 2 … 6.

(!U)
ATTENTION !
(!u)

Tant que vous ne coupez pas la machine, le g‚n‚rateur d'horloge fonctionne 
avec la derniŠre fr‚quence ‚crite dans sa RAM. A la mise sous tension le 
g‚n‚rateur d'horloge copie lui-mˆme dans sa RAM la fr‚quence d'origine 
sauv‚e dans sa EEPROM. Appuyer sur CTRL ou ALT ne sert donc … rien si l'on 
ne coupe pas la machine ‚galement. Vous pouvez aussi utiliser CTRL-ALT-UNDO
pour restorer les valeurs par d‚faut des param‚tres NVRAM/Flash ou encore 
passer par le mode 030 pour choisir une autre fr‚quence.

(!U)
Initialisation
(!u)

La fr‚quence d'origine sauv‚e en EEPROM est aussi modifiable aprŠs 
confirmation via un double clic sur 'Sauve' mais ceci est trŠs dangereux !

Toutefois en cas d'impossibilit‚ de red‚marrer la machine, il reste 
possible de raccorder le (!B) module ak-modul-bus (!b) sur le port MODEM 2 
via un cable de liaison HE10 SUBD et de reprogrammer en mode 030 la 
EEPROM du module avec le bouton 'Sauve'. Cette manipulation est par ailleurs 
indispensable pour un module neuf. (!B) Le module doit ˆtre aliment‚ par la 
CT60 et les signaux SDA et SCL ne doivent pas ˆtre raccord‚s car en mode 
030 ils sont forc‚s … 0 par la CT60 ! (!b)

!image ..\img\subd.img
!begin_verbatim

!end_verbatim 

En cas d'impossibilit‚ de red‚marrer la machine avec le (!B) module CTCM 
(!b) il faut couper le pont pour diviser par deux la fr‚quence soit une 
plage de 33 … 66 MHz, et ensuite le reprogrammer … nouveau avec la CT60 en 
sauvant une nouvelle valeur dans la EEPROM. La fr‚quence est alors doubl‚e 
lorsque le pont est … nouveau en place !

La CT60 ne d‚marre pas avec le boost du Falcon si le pont est coup‚ 
(fr‚quence F030 > fr‚quence CT60 soit 33 MHz).

Comme le (!B) module ak-modul-bus (!b), il reste possible de raccorder 
le (!B) module CTCM (!b) sur le port MODEM 2 via un cable de liaison HE10 
SUBD et de reprogrammer en mode 030 la EEPROM du module avec le bouton 
'Sauve'.

(!B)ATTENTION ! Le boot 2.0 ne supporte plus le pont parceque l'horloge de 
la CTCM n'est pas stable (pas de PLL) et qu'il n'est pas possible de tester 
l'‚tat du pont.(!b) Aussi la plage de fr‚quence est de 66 … 110 MHz (le 
DALLAS utilis‚ sur la CTCM n'est pas certifi‚ pour fonctionner en dessous 
de 66 MHz).

!image ..\img\modem2.img
!begin_verbatim

!end_verbatim 


!subnode Boot

!image cpx4.img
!begin_verbatim

!end_verbatim

Sur cette page vour pouvez :

!begin_itemize
!item S‚lectionner l'ordre de boot sur les disques IDE et SCSI (8 choix).
!item S‚lectionner au d‚marrage le systŠme d'exploitation par d‚faut.
!item S‚lectionner au d‚marrage l'arbitration SCSI.
!item S‚lectionne au d‚marrage l'identificateur SCSI (0 to 7).
!item Changer le d‚lais de la pause au d‚marrage en secondes (vous avez 
besoin de beaucoup de temps si vous voulez tester la ST-RAM et la SDRAM).
!item Changer la vitesse du blitter.
!item S‚lectionner le transfert du TOS 4.0x en RAM avec utilisation de la 
PMMU (obsolŠte).
!item Sous TOS, couper les caches pendant 5 secondes lors du lancement 
d'un programme ou supprimer la boite d'alerte copyback.
!item Rediriger l'affichage des programmes du dossier AUTO vers un fichier boot.log.
!item Avec une Radeon/CTPCI avoir un debug dans un fichier video.log:
!image cpx4_pci.img
!item Avec une CTPCI inverser les deux ports IDE (CTPCI et FALCON).
!end_itemize

Remarque: Tous ces r‚glages sont ‚crits en NVRAM ou dans les paramŠtres en 
flash via le bouton 'OK'.


!subsubnode S‚lection TOS en RAM (obsolŠte)

(!B)The option est seulement disponible si la version du boot est inf‚rieure
… 2.00.(!b) En effet ce dernier ex‚cute les patches sur le TOS et le copie 
en SDRAM.

Quand cette option est activ‚e, le TOS est copi‚ en SDRAM de $E00000 … 
$EEFFFF (le dernier secteur de la flash de $EE0000 … $EFFFFF est 
utilis‚ pour sauver 16 paramŠtres), et les variables TOS ont copi‚s.

!begin_itemize

!item Si seulement le TOS est utilis‚, vous pouvez activer cette option 
pour augmenter les performances.

!item Si la protection m‚moire est utilis‚e sous MiNT, n'activez pas 
cette option. L'arbre PMMU existe toujours, mais le cookie 'PMMU' 
n'existe pas quand cette option est supprim‚e.

!end_itemize 


!subnode Arrˆt/Divers

!image cpx5.img
!begin_verbatim

!end_verbatim

Sur cette page vous pouvez :

!begin_itemize
!item S‚l‚ctionner le mode d'extinction programm‚e aprŠs une proc‚dure 
shutdown.
!item Entrer l'heure d'arrˆt si le mode d'arrˆt est activ‚.
!item Activer le bip d'alame de la phase d'arrˆt.
!end_itemize

!image cpx5_pci.img
!begin_verbatim

!end_verbatim

Si l'affichage se fait via les Radeon/CTPCI vous pouvez :

!begin_itemize
!item S‚l‚ctionner le mode d'extinction programm‚e aprŠs une proc‚dure 
shutdown.
!item Entrer l'heure d'arrˆt si le mode d'arrˆt est activ‚.
!item Activer le bip d'alame de la phase d'arrˆt.
!item Mettre le moniteur en veille aprŠs un certain temps (inhib‚ si 0).
!end_itemize

Remarque: Tous ces r‚glages sont sauv‚s dans le CPX avec le bouton 'Sauve' 
(et pas en NVRAM ou dans les paramŠtres en flash). La gestion est faite 
par CT60TEMP.ACC/APP.


!subnode Langage

!image cpx6.img
!begin_verbatim

!end_verbatim

Sur cette page vous pouvez :

!begin_itemize
!item S‚lectionner au d‚marrage la langue par d‚faut.
!item S‚lectionner au d‚marrage le type de clavier.
!item S‚lectionner au d‚marrage le format de la date.
!item S‚lectionner au d‚marrage le format de l'heure 12 ou 24 heures.
!item Choisir au d‚marrage le s‚parateur de date.
!end_itemize

Remarque: Tous ces r‚glages sont ‚crits en NVRAM via le bouton 'OK'.


!subnode Vid‚o (boot)

!image cpx7.img
!begin_verbatim

!end_verbatim

Sur cette page vous pouvez :

!begin_itemize
!item S‚lectionner au d‚marrage le type de moniteur.
!item S‚lectionner au d‚marrage le mode d'affichage : NTSC = 60 Hz, PAL = 
50 Hz. 
!item S‚lectionner au d‚marrage la r‚solution de l'‚cran.
!item S‚lectionner au d‚marrage le nombre de couleurs.
!item S‚lectionner au d‚marrage le mode de compatibilit‚ ST.
!item S‚lectionner au d‚marrage le mode overscan sur TV.
!item Remplacer la lecture NVRAM par les valeurs TOS sauv‚s en Flash et 
utiliser l'horloge IKBD au lieu du RTC. Cette possibilit‚ est la pour 
corriger les problŠmes occasionn‚s par la pile us‚e.
!end_itemize

Remarque: Tous ces r‚glages sont ‚crits en NVRAM via le bouton 'OK'.

!image cpx7_pci.img
!begin_verbatim

!end_verbatim

Si l'affichage se fait via les Radeon/CTPCI vous pouvez :

!begin_itemize
!item S‚lectionner au d‚marrage la r‚solution de l'‚cran, si le mode vid‚o 
pr‚f‚r‚ du moniteur est touv‚ il est ajout‚ … la liste.
!item S‚lectionner au d‚marrage le nombre de couleurs (256/65K/16M).
!item S‚lectionner au d‚marrage la configuration des moniteurs (MON.1,MON.2) :
!begin_itemize
!item DEFAULT (mode automatique)
!item CRT,NONE
!item CRT,CRT
!item CRT,TMDS
!item TMDS,CRT
!item TMDS,TMDS
!end_itemize
!item S‚lectionner l'utilisation du DMA pour acc‚l‚rer l'affichage (ATTENTION !
Actuellement parfois cette option peut geler votre systŠme - hardware bug). 
!item Remplacer la lecture NVRAM par les valeurs TOS sauv‚s en Flash et 
utiliser l'horloge IKBD au lieu du RTC. Cette possibilit‚ est la pour 
corriger les problŠmes occasionn‚s par la pile us‚e.
!end_itemize

Remarque: Le mode pour les Radeon/CTPCI n'‚crase pas le mode Videl, le mode 
est ‚crit dans un paramŠtre en flash avec le bouton 'OK'.


!subnode CT60TEMP.APP

Ce programme est cr‚‚ par le CPX. Pour surveiller la temp‚rature, remonter 
les courbes, mesurer la charge CPU moyenne, arrˆter la machine, ou mettre en 
veille le moniteur (sous Radeon/CTPCI), le CPX :

!begin_itemize
!item Sous TOS cr‚e l'accessoire CT60TEMP.ACC et demande de rebooter.
!item Sous MiNT cr‚e l'application CT60TEMP.APP et la lance.
!item Sous MagiC lance un thread.
!end_itemize

Quelque soit la solution utilis‚e (thead, accessoire ou application), il 
est possible de profiter des touches multim‚dia de l'interface PS/2 Eiffel 
(http://eiffel3.atari.org), surtout avec le jeu num‚ro 2 PS/2. La touche 
(!B) POWER (!b) lance le mode d'extinction imm‚diat aprŠs une proc‚dure de 
shutdown. 

Si on utilise CT60TEMP.APP sous MagiC ou MiNT (pour MagiC booter sous TOS 
et copier CT60TEMP.ACC en CT60TEMP.APP), en utilisant les variables 
d'environnement, il est possible d'utiliser d'autres touches multim‚dia de 
l'interface PS/2 Eiffel :

!begin_itemize
!item (!B) WWW HOME : (!b) Lance le navigateur internet via la variable 
d'environnement BROWSER.
!item (!B) E-MAIL : (!b) Lance le logicel de messagerie via la variable 
d'environnement MAILER.
!item (!B) WWW SEARCH : (!b) Lance le navigateur internet via la variable 
d'environnement BROWSER avec la page d'accueil de Google.
!item (!B) MY COMPUTER : (!b) Lance le visualisateur hypertexte via la 
variable d'environnement HELPVIEWER avec la documentation de la CT60.
!end_itemize

Il faut imp‚rativement installer le programme E_TEMP.PRG dans le dossier 
AUTO (utilisation du cookie 'Eiff').


!subnode Informations sur la SDRAM

Sur cette page vous pouvez voir :
                                       
!begin_itemize

!item Le type de m‚moire (SDRAM).
!item Le nombre de lignes d'adresses.
!item Le nombre de colonnes d'adresses.
!item Le nombre de banques DIMM (1 ou 2).
!item La largeur de donn‚es du module (64).
!item Le niveau de tension de l'interface (LVTTL).
!item Le temps de cycle SDRAM (par exemple 10 nS pour une PC100).
!item Le temps d'accŠs de l'horloge SDRAM.
!item Le type SDRAM (sans parit‚).
!item La fr‚quence rafraichissement (15.625 uS ou 7.8 uS).
!item Le nombre de banques.
!item Le temps de latence pour CAS (2).
!item Le temps de latence pour CS (0).
!item Le temps de latence pour WE (0).
!item Les attributs du module (sans buffers).
!item Le temps de pr‚chage minimum des lignes.
!item Le d‚lais minimum entre activations de lignes.
!item Le d‚lais minimum entre RAS et CAS.
!item La largeur minimale de l'impulsion RAS.
!item La densit‚ d'une banque du module (en Mo).
!item L'ID du fabriquant du module (en hexa/ASCII).
!item La r‚f‚rence du module (en ASCII).
!item La date de fabrication du module (semaine/ann‚e).
!end_itemize

Ces valeurs sont stock‚s dans une petite EEPROM sur le module.
 

!subnode BubbleGEM

 Avec un systŠme multitƒche (par exemple MagiC, MultiTOS, Geneva,
etc...) BubbleGEM peut ˆtre plac‚ dans le r‚pertoire de d‚marrage
auto start o— il sera automatiquement lanc‚ comme un programme GEM
au d‚marrage du systŠme.

 Sur un TOS monotƒche BubbleGEM peut ˆtre lanc‚ commme un accessoire
de bureau en renommant BUBBLE.APP par BUBBLE.ACC et copi‚ sur la 
racine du r‚pertoire de boot de votre disque. 

 Un programme enverra un message … BubbleGEM qui tourne en parallŠle
et transmettra une chaŒne de caractŠres lorsque l'utilisateur aura
cliqu‚ avec le bouton droite sur une ic“ne, un bouton ou dans une
zone d‚termin‚e d'une fenˆtre. BubbleGEM affichera cette chaŒne de
caractŠres plac‚e dans une jolie bulle, jusqu'… ce que l'utilisateur
d‚place le pointeur de la souris dans une autre zone qu'il veut
explorer, alors la bulle disparaitra (on peut aussi presser une
touche ou un bouton de la souris).

 Pendant que la bulle d'aide est ouverte, deux raccoucis clavier
sont possibles:
<CTRL C> : Le contenu de la bulle est copi‚ dans le presse-papier
           et la bulle toujours pr‚sente.
<CTRL X> : Le contenu de la bulle est ‚galement copi‚ dans le 
           presse-papier mais la bulle est ferm‚e.

 Thomas Much est l'auteur de BubbleGEM, son adresse e-mail est:

 Thomas.Much@stud.uni-karlsruhe.de


!node Cache

!subnode Les caches du 68060

Le 68060 a deux caches de 8Ko, donn‚es et instructions.

La ST-RAM est en writethrough, … chaque fois que le 68060 ‚crit dans la 
RAM, il ‚crit en mˆme temps dans le cache de donn‚es.

La SDRAM est en copyback, le 68060 ‚crit toujours dans son cache de 
donn‚es, il ‚crit dans la m‚moire les donn‚es les plus anciennes de son 
cache pour lib‚rer de la place.

Le 68060 a aussi un cache instruction, dont le seul lien direct avec le 
cache de donn‚es est la m‚moire. En cons‚quence il peut y avoir 
incoh‚rence entre le cache de donn‚es et le cache instruction. L'exemple 
principal ‚tant l'exc‚cution d'un programme relog‚, sans traitement 
particulier et sans appel systŠme c'est le plantage.

Le 68060 a la possibilit‚ de surveiller le bus externe pendant les accŠs 
des autres maitres du bus (comme le DMA ou le blitter), afin de maintenir 
la coh‚rence entre les caches du 68060 et la m‚moire externe.


!subnode GENERAL6.CPX

Ce CPX est une version patch‚e de GENERAL.CPX du Falcon pour le 68060. 
La s‚lection avec/sans cache utilise maintenant des appels XBIOS, il 
n'y a pas de problŠmes sous TOS parceque le XBIOS est contenu en FLASH 
mais sous MagiC si vous utilisez ce CPX vous devez installer 
CT60XBIO.PRG dans le dossier AUTO. Ce programme installe le XBIOS 
pour la CT60 si le cookie 'CT60' n'est pas trouv‚.


!subnode XCONTROL, ZCONTROL, COPS, et la SDRAM en copyback

!begin_itemize

!item Seulement COPS fait un flush des caches aprŠs chargement des CPX et 
fonctionne trŠs bien.

!item ZCONTROL fonctionne sous MiNT 1.16/Xaaes.

!item XCONTROL plante.

!item La version patch‚e de XCONTROL.ACC corrige le problŠme par un nouveau 
appel XBIOS mais sous MagiC si vous utilisez cet ACC vous devez installer
CT60XBIO.PRG dans le dossier AUTO.

!end_itemize 

!subnode Modules PARX.SYS et le copyback

Si un programme qui utilise PARX.SYS plante au d‚marrage, vous 
pouvez essayer de couper les caches avec GENERAL6.CPX, lancer le 
programme et r‚activer les caches aprŠs. Par exemple PICCOLO 
fonctionne avec cette m‚thode.

Une solution globale est de couper les caches pendant 5 secondes lors du   
lancement d'un programme sous TOS via le menu Boot du CPX de 
configuration, mais cette m‚thode p‚nalise tous les programmes. 


!subnode Programmes TSR qui plantent dans le dossier AUTO

Tout comme les CPX, les programmes qui n'utilisent pas la fonction 
Pexec pour charger des modules plantent avec la SDRAM en copyback, 
aussi la meilleure solution est de charger le programme en ST-RAM 
(cache en writethrough). Vous pouvez utiliser FILEINFO.CPX pour modifier 
les flags.

Par exemple vous devez enlever les flags TT-ram de METAXBS.PRG 
(Metados) parceque quand les modules OVL sont charg‚s il n'y a pas de 
flush aprŠs la relocation, ce n'est pas compatible avec la SDRAM et 
le cache CPU en copyback.

Une solution globale est de couper les caches pendant 5 secondes lors du   
lancement d'un programme sous TOS via le menu Boot du CPX de 
configuration, mais cette m‚thode p‚nalise tous les programmes. 


!subnode Programmes compress‚s avec Ice

Le TOS teste les programmes compress‚s avec Ice, il y a un patch 
pour faire un flush des caches (dans la fonction Pexec). Sans ce patch, 
les programmes compress‚s avec Ice plantent avec le cache en copyback 
(SDRAM). Ce problŠme n'est pas corrig‚ sous MagiC ou MiNT.  


!node Compatibilit‚

!subnode Plantages

Vous pouvez essayer de couper les caches avec GENERAL6.CPX, lancer le 
programme qui plante au d‚marrage et r‚activer les caches aprŠs.

Vous pouvez utiliser FILEINFO.CPX pour modifier les flags et forcer le 
programme a utiliser la ST-RAM.

Pour plus d'informations, consulter le chapitre 'Cache'.


!subnode DSP

Le 68060 est beaucoup plus rapide que le DSP, ce qui amŠne des problŠmes 
avec le port host. Les fonctions XBIOS du TOS en flash corrigent ce 
problŠme en testant le bit de handshake a chaque mot envoy‚ ou re‡u. Sur 
MagiC il faut installer le programme DSPXBIOS dans le dossier AUTO.

Les programmes utilisant directement le DSP sans passer par les fonctions 
XBIOS (et ils sont nombreux !) peuvent donc poser problŠme. Pour continuer 
d'utiliser un tel programme, il faut couper les caches via le CPX 
GENERAL6.CPX. 


!subnode Patchs

!subsubnode MagiC

MAGXBOOT.PRG est r‚ecrit pour les modes normal (68030) et turbo 
(68060), et en turbo MAGIC.RAM est patch‚ pour ne pas ‚craser 
certaines parties du TOS comme l'‚muulation FPU, etc... Vous devez 
installer ce programme dans le dossier AUTO. Test‚ sous MagiC 6.10.

Vous devez utiliser le MAGIC.RAM patch‚ de Centek (avec MAGIC_P.PRG) 
avant d'utiliser MagiC. 

Vous devez installez CT60XBIO.PRG et DSPXBIOS.PRG dans le dossier 
AUTO.

Si vous avez les Radeon/CTPCI et drivers.hex charg‚, le VDI et le XBIOS 
du TOS sont utilis‚s pour l'affichage.


!subnode Solutions

!begin_table [|l|l|l|] !hline
(!B)Logiciel(!b) !! (!B)ProblŠme(!b)  !! (!B)Solution(!b)
!hline
Boot >= 2.00     !! Ne fonctionne pas !! Acheter un 68060 full.
et 68060 EC      !!                   !!
!hline
TOS drivers      !! Delais trop long  !! Les 15-20 secondes en plus au
Radeon/CTPCI     !! au boot           !! boot servent … initialiser la
                 !!                   !! carte via un ‚mulateur X86.
!hline
HD Driver 8 et   !! Plante avec choix !! Mettre … jour ABE060 
disques SCSI ou  !! "SCSI Processeur  !! vers v5K ou plus.
le lecteur de    !!  Device"          !!
disquettes       !!                   !!
!hline
HD Driver 8 et   !! ProblŠmes quand   !! Mettre … jour HD Driver 
le bug IO7 MFP 1 !! SDMA fonctionne   !! (8.13 ou plus).
                 !! avec le D2D       !!
!hline
SpeedoGDOS 5     !! Plante            !! Utiliser le lanceur SPDGDOS.PRG
                 !!                   !! pour couper les caches pendant
                 !!                   !! l'ex‚cution du vrai SPDGDOS.PRG.
!hline
SpeedoGDOS 5     !! Instable          !! Utiliser NVDI.
!hline
fVDI/radeon.sys  !! Plus lent que le  !! Utiliser NVDI.
                 !! TOS               !!
!hline
fVDI/radeon.sys  !! Sans remplissage  !! v_contourfill pas impl‚ment‚e
                 !! dans les prog.    !! dans fVDI. Utiliser NVDI.
                 !! de dessin         !!
!hline
NVDI 5           !! Ne fonctionne pas !! Renommer tous les NVDIDRV*.SYS
                 !! sur Radeon/CTPCI  !! NVDIDRV*.SY (par exemple). 
!hline
MagiC 6          !! Ne fonctionne pas !! Patcher MAGIC.RAM et utiliser
                 !!                   !! le nouveau MAGXBOOT.PRG.
                 !!                   !! Installer CT60XBIO.PRG et 
                 !!                   !! DSPXBIOS.PRG dans le dossier
                 !!                   !! AUTO aprŠs MAGXBOOT.PRG.
!hline
MagiC 3-4-5      !! Ne fonctionne pas !! Utiliser MagiC 6.
!hline
Cubase Audio     !! Ne fonctionne pas !! Patcher CAF_20x.PRG d‚compact‚
                 !!                   !! par NEW DEPACK et utiliser 
                 !!                   !! le nouveau CAF_060.PRG cr‚‚.
                 !!                   !! Installer EXCEP060.PRG dans le 
                 !!                   !! dossier AUTO, et le MROS3_45 
                 !!                   !! patch‚. 
!hline
Spin METAXBS.PRG !! Plante            !! Enlever les flags Fast-Ram.
!hline
Picollo          !! Plante            !! Couper les caches au lancement
D2M              !! Plante            !! ou enlever les flags Fast-Ram
Gemview          !! Plante            !! ou utiliser le delais cache
Gembench         !! Plante            !! dans le CPX de configuration
Swiftel Photo    !! Plante            !! sous TOS.
!hline
Xcontrol         !! Plante            !! Utiliser la version patch‚e.
!hline
!end_table

!begin_table [|l|l|l|] !hline
(!B)Hard(!b) !! (!B)ProblŠme(!b) !! (!B)Solution(!b)
!hline
F030/DSP     !! Erreurs DSP      !! Ne pas utiliser l'horloge CT60 (fil trop
             !!                  !! long) et placer un oscillateur de 50 MHz
             !!                  !! sur le 32 MHz d'origine … cot‚ du DSP.
!hline
F030/SDMA    !! Erreurs DSP avec !! Contr“ler l'horloge SDMA.
             !! les transferts   !!
             !! DMA -> DSP ou    !!
             !! clics pendant    !!
             !! la lecture SDMA  !!
!hline
Blitter      !! Pixels           !! Essayer blitter lent dans CT60CONF.CPX.
             !! mauvais          !! Baisser l'hologe F030 … 20/40 MHz ou
             !!                  !! 16/32 MHz.
             !!                  !! Utiliser NVDI.
!hline
Ethernec     !! Lent et/ou       !! Installer les drivers CT60 (sans movep).
             !! erreurs          !! Utiliser seulement … 16/32 MHz.
!hline
Eclipse      !! Ne fonctionne    !! Couper la piste entre les pins 20 et 22.
             !! pas              !! Mettre … jour ABE060 vers v5I ou plus.
             !!                  !! Essayer seulement … 16/32 MHz.
!hline
CTPCI        !! Ne fonctionne    !! Mettre … jour ABE/SDR060 vers v7 ou plus.
             !! pas              !!
!hline
CTPCI        !! Pas de cartes    !! Controler le 3V3 et les nappes 2x80 fils.
             !! PCI d‚tect‚es    !!
!hline
CTPCI        !! Erreur de parit‚ !! R‚duire la longueur des nappes 2x80 fils.
             !!                  !! Contacter Rodolphe.
!hline
CTPCI        !! Les cartes PCI   !! Attendre une mise … jour hard de Rodolphe.
             !! USB/Ethernet ne  !!
             !! fonctionnent pas !!
!hline
Radeon       !! Ne fonctionne    !! Utiliser une Radeon pour PC. 
pour MAC     !! pas              !! Le TOS utilise un ‚mulateur X86 pour
             !!                  !! initialiser la carte.
!hline
Radeon 7000  !! DVI ne fonctionne!! Il y a des problŠmes de temp‚rature si
(RV100)      !! pas              !! l'horloge vid‚o d‚passe 135 MHz sur RV100.
             !!                  !! Maintenant les modes les plus hauts sont
             !!                  !! rejet‚s (drivers V1.01).
!hline
!end_table


!node CT60 HARDWARE GUIDE (Anglais)

(!B)
Rev 5.2  October 2000 / February 2004
(c) Rodolphe Czuba
(!b)

!subnode FUNCTIONAL BLOCK DIAGRAM

!image ..\img\ct60arch.img


!subnode ADDRESSES & REGISTERS

!subsubnode 68030 VIEW 24-Bit MAP 

!begin_verbatim
$xx000000 $xxDFFFFF  14 MB  ST-RAM
$xxE00000 $xxEFFFFF   1 MB  TOS 4.0x ROM - BOOT   
$xxE00000 $xxEFFFFF   1 MB  CT60 FLASH  CPU SPACE #3  
$xxF00000 $xxF0FFFF  64 KB  I/O IDE     
$xxF10000 $xxF9FFFF 576 KB  F030 BUS SLOT    
$xxFA0000 $xxFBFFFF 128 KB  CARTRIDGE SLOT    
$xxFC0000 $xxFEFFFF 192 KB  Unused    
$xxFF0000 $xxFFFFFF  64 KB  I/O    
!end_verbatim


!subsubnode 68060 VIEW 32-Bit MAP  
                
!begin_verbatim 
$00000000 $00DFFFFF   14 MB  ST-RAM               CACHE    - NO BURST
$00E00000 $00EFFFFF    1 MB  CT60 FLASH           CACHE    - NO BURST
$00F00000 $00F0FFFF   64 KB  I/O IDE              NO CACHE - NO BURST
$00F10000 $00F9FFFF  576 KB  F030 BUS SLOT        NO CACHE - NO BURST 
$00FA0000 $00FBFFFF  128 KB  CARTRIDGE SLOT       NO CACHE - NO BURST 
$00FC0000 $00FEFFFF  192 KB  Unused               NO CACHE - NO BURST
$00FF0000 $00FFFFFF   64 KB  I/O                  NO CACHE - NO BURST
$01000000 $20FFFFFF  512 MB  SDRAM (TT-RAM)       CACHE    - BURST
$21000000 $3FFFFFFF  496 MB  Reserved             CACHE    - BURST
$40000000 $7FFFFFFF 1024 MB  060 BUS SLOT         CACHE    - BURST 
$80000000 $BFFFFFFF 1024 MB  060 BUS SLOT         NO CACHE - NO BURST
$C0000000 $EFFFFFFF  768 MB  Reserved             NO CACHE - NO BURST
$F0000000 $FBFFFFFF  192 MB  CT60 I/O             NO CACHE - NO BURST
$FC000000 $FEFFFFFF   48 MB  Reserved             NO CACHE - NO BURST
$FF000000 $FFFFFFFF   16 MB  FALCON 24-Bit SHADOW NO CACHE - NO BURST
!end_verbatim

From the 030, the FLASH chip is accessible (to program and read it) by the 
030 CPU SPACE #3. 

From the 060, the TOS chip is NOT accessible.
The FLASH is seen at the TOS addresses when booting.
When programming the Flash, the 060 ALTERNATE SPACE #3 must be used.


!subsubnode REGISTERS SUMMARY

(!B)
SDR-60
(!b)

!begin_verbatim
EE EECL   $F0000000 I2C port for EEprom DIMM
   EEDA   $F0800000
  
TH THCS   $F1000000 THermal sensor of the 060  
   THCK   $F1800000  
   THDA   $F1000000

SDCNF     $F2000000 SDram CoNFiguration

IVR       $F3000000 Int Vector Register
!end_verbatim

(!B)
ABE-60
(!b)

!begin_verbatim
FWEN      $F9000000 Flash Write ENable  (only from the 060/PPC)

SLP       $FA000000 Sleep = Turn OFF the ATX power supply.
!end_verbatim


!subsubnode SDR60 REGISTERS DETAILS

(!U)
SDRAM EEPROM I2C Port :
(!u)

!begin_verbatim
EECL (EEprom serial CLock)
 Write at $F0000000 : WRITE 0 to EECL line.
 Write at $F0400000 : WRITE 1 to EECL line.
 Read  at $F0000000 : READ from the EECL line on the D1 CPU data line.

EEDA (EEprom serial DAta) 
 Write at $F0800000 : WRITE 0 to EEDA line.
 Write at $F0C00000 : WRITE 1 to EEDA line.
 Read  at $F0000000 : READ from the EEDA line on the D0 CPU data line.
!end_verbatim

(!U)
060 THERMAL 3-wires Port :
(!u)

!begin_verbatim
THCS (THermal Chip Select)
 Write at $F1000000 : WRITE 0 to CS line.
 Write at $F1400000 : WRITE 1 to CS line.

THCK (THermal ClocK) 
 Write at $F1800000 : WRITE 0 to CLK line.
 Write at $F1C00000 : WRITE 1 to CLK line.

THDA (THermal DAta)
 Read  at $F1000000 : Read from the DO line on the D0 CPU data line.
!end_verbatim

(!U)          
INTERRUPT REGISTER :
(!u)

!begin_verbatim
IVR (Interrupt Vector Register)
 Read at $F3000000
!end_verbatim

(!U)
SDRAM CONTROLLER :
(!u)

!begin_verbatim
SDCNF (SDram CoNFiguration)
 Write a long at $F2xx0000 with xx = [A23..A16]
 
Chip DensitY (EEPROM Byte #3 & #4) 		
A23 = cdy2                                           EEPROM
A22 = cdy1                                       Byte#3  Byte#4
     [cdy2,cdy1] = 0,0 --> 8Mx8 / 8x16              $0C $09
                 = 0,1 --> 16Mx8                    $0C $0A
                 = 1,0 --> 16Mx16                   $0D $09
                 = 1,1 --> 32Mx8 / 32Mx16           $0D $0A
	
Number of DIMM Banks (EEPROM Byte #5)
A20 = nrb
     [nrb] = 0 --> 1 bank
           = 1 --> 2 banks 

Module DensitY (EEPROM Byte #31 * EEPROM Byte #5)
A19 = mdy2
A18 = mdy1
     [mdy2,mdy1,mdy0] = 0,0 -->  64MB
                      = 0,1 --> 128MB
                      = 1,0 --> 256MB
                      = 1,1 --> 512MB

ReFresh RaTe (EEPROM Byte #12)
A16 = rfrt
     [rfrt] = 0 --> 15.625 uS
            = 1 --> 7.8125 uS
!end_verbatim


!subsubnode ABE60 REGISTERS DETAILS

!begin_verbatim
FWEN (Flash Write ENable)
 Only for the PowerPC write accesses.
 Not needed for 030 and 060 write accesses. 
 Write at $F9000000 : Can write
 Write at $F9800000 : Cant write

SLP (SleeP)
 Write at $FA800000 : Turn OFF the power supply.
!end_verbatim


!subnode 060 BUS SLOT

A 060 bus Slot is present on the CT60 for some future daughter cards like 
the PCI adaptor or a PPC developers system. 

A minimal and usefull connector was choosen. It has only 100 pins (2 
connectors of 2x25 pins) and furnishes the following signals and power 
lines.  

(!B)
Signals Groups
(!b)

(!U)
ADDRESS & DATA
(!u)
!begin_verbatim
A31-A0    Address Bus
D31-D0    Data Bus
!end_verbatim

(!U)
TRANFER CONTROL
(!u)
!begin_verbatim
/TS                      Transfer Start
R/W                      Read Write
/BS0, BS1/, /BS2, /BS3   Byte Select
SIZ1, SIZ0               SIZe
TT1, TT0, TM2, TM1, TM0  Transfer Type & Transfer Modifier
/TA                      Transfer Acknowledge
!end_verbatim

(!U)
ARBITRATION
(!u)
!begin_verbatim
/BR     Bus Request
/BG     Bus Grant
/BB     Bus Busy
!end_verbatim

(!U)
INTERRUPTS
(!u)
!begin_verbatim
/TEA    Transfer Error Acknowledge
/RST    ReSeT
/I6     Interrupt 6 : Sent by the daughter card to the CT60
/INT    INTerrupt : Sent by CT60 to the daughter card for a PPC
!end_verbatim

(!U)
CLOCK
(!u)
!begin_verbatim
CLK     CLocK (CT60 clock : 64MHz or more)
!end_verbatim

(!U)
POWER
(!u)
!begin_verbatim
-12V, +12V   Power supplies : used by some PCI cards and the fans (+12).
+3.3V, +5V   Power supplies : used by components and processors.
             Each pin can drive up to 6 Amperes.
GND (9)      GrouND pins.
!end_verbatim
   
(!B)
Pinout
(!b)

(!U)
Add Connector Data Connector
(!u)
!begin_verbatim
#A1  #A2      #D1  #D2
GND  GND      GND  GND 
+5V  /BR      TM0  +12V
/TS  /BG      TM1  -12V
R/W  /BB      TM2  +3.3V
SIZ0 SIZ1     TT0  TT1
/TA  /TEA     /BS0 /BS1
     CLK      /BS2 /BS3
/RST GND      /I6  /INT
A30  A31      D0   D1
..   ..       ..   ..
A0   A1       D30  D31
GND  GND      GND  GND
#A49 #A50     #D49 #D50
!end_verbatim 


!subnode HARDWARE EMULATION

The CT60 allows a (!B) Falcon hardware emulation. (!b)

With this Hardware Emulation Window, it is easy to implement a new chip 
replacing the old one of the Falcon motherboard and this at the same 
address(es) !

(!U)
Examples :
(!u)
!begin_itemize
!item SUPER-VIDEL chip in a FPGA with DDR memory.
!item SDRAM replacement of a part of the ST-RAM at the same addresses.
!item ACIA for new PS/2 ports with a CPLD/FPGA.
!item ACIA MIDI with a CPLD/FPGA.
!item DSP56301 replacing 56001 at same addresses !
!item FPGA emulating serial & parallel port of the Falcon (Zilog 85C30 and Yamaha).
!item New SDMA for Audio.
!end_itemize

There is a time window from the start of the 060 access to the Falcon 
addresses ($00xxxxxx and $FFxxxxxx) up to the start (rising edge) of the 
7th cycle of the CLK (bus and 060 clock).

When the 060 inserts the addresses and TS to validate, a counter into ABE 
start if the address is somewhere in the Falcon address space.
Until the counter reaches the end of the 6th cycle, a card on the 060 
slot bus of the CT60 can answer to terminate the access instead of a chip 
of the Falcon mb (with TA/ or TEA/ or both TA/ & TEA/ for a RETRY).
This termination of the access terminates the counter and invalidates the 
Falcon acccess that was started.

At the begining of the 7th cycle the Falcon READ access continues and 
cannot be stopped. ABE drives data on the CT60 bus.

The time limit for the termination signal sampling is the end of the 6th 
cycle.

(!U)
If you want to use SDRAM on a daughter card :
(!u)

For 66 MHz SDRAM BURST READ you need 5-1-1-1 cycles.
The TA arrives the 5th cycle (first data) up to 8th (fourth data). This 
TA arrives before the end of the 6th cycle and the F030 access start is 
cancelled.

For 66 MHz SDRM BURST WRITE you need 3-1-1-1 cyles.
The TA arrives the 3rd cycle (first data) up to 6th (fourth data). This 
TA arrives before the end of the 6th cycle and the F030 access start is 
cancelled.

(!U)
For registers accesses on a daughter card, you need 2 or 3 cycles.
(!u)

If you want to write both to F030 mb AND your daughter card (an adress 
that is present on the two boards), don't send TA from the daughter card 
and the TA from mb will terminate the write access for you.

(!U) By example, (!u) this technic allows to write all VIDEL and SUPER VIDEL 
registers in the same time. The emulation is total! The only thing is to do 
is to implement a bit in the daughter board to (!B) switch ON/OFF the 
emulation. (!b)

(!B)
If the switch is ON :
(!b)
!begin_itemize
!item the daugther card address registers are at the same addresses than the 
F030 mb and :
!item the TA must not be sent when writting these registers that are common to 
F030 and the daughter card.
!item the TA must be sent before the 7th cycle when reading from register that 
is a common to F030 & daughter card.
!end_itemize

(!B)
If the switch is OFF :
(!b)
!begin_itemize
!item the daughter card address registers must be present at some specific 
addresses (not the same than the F030) and the TA is sent as usual by the 
daughter card for all read & write accesses.
!end_itemize

(!U)
Example with $FFFF820E :
(!u)

Switch is ON -> Write at $FFFF820E write to daughter card and F030 mb and 
this access is terminated by the TA from Falcon mb (ABE). The card don't 
send TA.

Switch is OFF -> Write at $FFFF820E write only to Falcon mb. You need to 
write to a 'new' address on the card to access the same register.


!subnode THERMAL SENSOR

The 68060 contains a Die Temperature Sensor with two external pins THERM0 
& THERM1. The sensor is done with a temperature sensitive resistor which 
has a 780 ohms value at 25øC and increases/decreases by steps of 2.8 ohms 
per øC unit. By example, a 060 core at 80øC gives a resistance of 934 ohms 
between the two THERMx pins.

(!B)
Equations :  R60 = 780 + 2.8 x (TEMP  25) or TEMP = (R60 - 710) / 2.8
(!b)

The CT60 uses a small slow Analog/Digital converter (TI TLV0831) to obtain 
a 8-Bit value of the voltage between the THERMs pins.  

(!B) The equation is : U60 = (3.34 x R60) / (1000 + R60) (!b) where R60 is 
the value of the core sensor resistor; 3.34 is the power supply and 1000 
is the value of the resistor connected between the 3.34V and the positive 
THERM0/IN+ line.

(!U)
TOLERANCES :
(!u)

!begin_itemize
!item Power supply : 3.3V +/- 4% : From 3.168V to 3.432V. Curently, it is 
3.30 to 3.34. 
!item Resistor : 1K +/-1% : From 990 to 1010 Ohms. Curently, it is from 
995 to 1005 ohms.
!end_itemize

The AD converter uses a REF voltage of 1.800 V. With 0 to 0.007 V between 
the two pins of the AD converter, the digital result is 0. With 1.794 to 
1.800 V, the result is 255. The value increases/decreases by steps of 
0.007 V.

(!B)
The equation is :  Data = INT [U60/0.007]. 
(!b)

!begin_verbatim
At   0øC : Vin+ = 1.387 V  Data = 197  R60=710 
At  25øC : Vin+ = 1.464 V  Data = 208  R60=780 
At  50øC : Vin+ = 1.535 V  Data = 218  R60=850 
At 100øC : Vin+ = 1.662 V  Data = 236  R60=990 
!end_verbatim

(!U)
ATTENTION : The varation of the data is not linear !!
(!u)

The CPU must access the TLV831 by a basic bit-by-bit protocol. It is the 
software responsibility to respect the protocol &  timings of the 
following chronogram, and assemble the bits.  

!image ..\img\tlv.img

!begin_verbatim
f   : Clock frequency                         10 to 600 kHz (typical = 250)
tsu : Setup time, CS LOW before CLK goes HIGH 350 ns MIN
tpd : Propagation delay time :
      output data after CLK goes HIGH         500 ns MAX (typical = 200)
twh : Pulse duration, CS HIGH                 220 ns MIN
tconv : Converstion Time (at 250kHz)          32 us 
!end_verbatim

Three registers are present in the SDR60 chip.

The 060 CPU must drive THCS & THCK and read THDA by these registers.

The address $F1000000, $F1800000 & $F1000000 are used respectively for 
THCS, THCK & THDA.  

!begin_verbatim
THCS (Chip Select)
LONG WRITE at $F1000000   WRITE 0 to CS Rising edge of CS (removed)
LONG WRITE at $F1400000   WRITE 1 to CS Falling edge of CS (active)

THCK (Clock)
LONG WRITE at $F1800000   WRITE 0 to CLK Falling edge of CLK
LONG WRITE at $F1C00000   WRITE 1 to CLK Rising edge of CLK

THDA (Data Output)
LONG READ at $F1000000   READ from DO
                         Value is available on D0 of the CPU data bus.
!end_verbatim

For an example, see the example in the DIMM EEPROM chapter.


!subnode DIMM EEPROM

!subsubnode EEPROM DATA

The DIMM standard allows the loading of the manufacturer informations from 
a small 128 or 256 bytes EEPROM on the DIMM. Some of these informations 
are needed to configure the SDRAM controller of the CT60.  

The following bytes are uses by the CT60 :

!begin_itemize
!item (!B) Bold (!b) are used by the boot software to configure the SDRAM 
controller. 
!item Others are used only as user information in a SET UP menu.
!end_itemize

!begin_table [|l|l|l|] !hline
Byte 2     !! Memory Type                !! FPM, EDO, NIBBLE, SDRAM (=$04)
(!B)
!hline
Byte 3     !! Number of Row Addresses    !! 11,12,13,. : $B:11 / $C:12 / $D:13
!hline
Byte 4     !! Number of Column Addresses !! 8,9,10,... : $8:8  / $9:9  / $A:10
!hline
Byte 5     !! Number of DIMM Banks       !! 1 or 2  $01:1 / $02:2
!hline
(!b)
Byte 6-7   !! Module Data Width          !! 64, 72 , 80, : $4000
!hline
Byte 8     !! Voltage Interface Level    !! TTL, LVTTL (1), HSTL, SSTL3, SSTL2
           !! of this assembly           !!
!hline
Byte 9     !! SDRAM Cycle Time (tCYC)    !!
!hline
Byte 10    !! SDRAM Access from Clock    !!
           !! (tAC)                      !!
!hline
Byte 11    !! SDRAM Configuration Type   !! None, Parity, ECC
(!B)
!hline
Byte 12    !! Refresh Rate               !! 15.625uS:$80, 7.81uS:$82 
!hline
(!b)
Byte 17    !! Number of Banks            !! 2 or 4 ($04)
           !!  on SDRAM Device           !!
!hline
Byte 27    !! Minimum ROW Precharge      !!
           !!  Time (tRP)                !!
!hline
Byte 28    !! Minimum ROW Active to      !!
           !!  Active Delay (tRRD)       !!
!hline
Byte 29    !! Minimum RAS to CAS Delay   !!
           !! (tRCD)                     !!
(!B)
!hline
Byte 31    !! Module Bank Density        !! 16 ($04), 32 ($08), 64 ($10),
           !!                            !! 128 ($20), 256 ($40), 512 ($80)
!hline
(!b)
Byte 64-71 !! Module Manufacturers       !! EX : $A4000000 = IBM
           !!  JEDEC ID Code             !!
!hline
Byte 73-90 !! Module Part Number         !!
!hline
Byte 93-94 !! Module Manufacturing Date  !!
!hline
Byte 95-98 !! Module Serial Number       !!
!hline
!end_table

Some features are initialized by the logic chip into the DIMM module when 
booting : 

!begin_itemize
!item BURST Length 1, 2, 4, 8 , Page.  4 is for 060, PPC, X86 processors
!item CAS Latency  2, 3, 4,...  2 is possible with PC100 at 66 up to 80 MHz !
!end_itemize

(!B)
Remarks :
(!b)

!begin_itemize
!item Don't confuse SDRAM banks (2 or 4) with DIMM banks (1 or 2) !
!item Bytes 128-255 are open for Customer Use and can be written - Not used 
with CT60. 
!item DIMM Density = Module Bank Density * Number of DIMM Banks (1 or 2).
!end_itemize


!subsubnode I2C 2-wire PROTOCOL

The EEPROM device conforms to the I2C 2-wire protocol. CT60 only uses the 
random read operations with the EEPROM. 

During data input, the EEPROM samples the SDA signal on the rising edge of 
the clock (SCL). For correct device operation, the SDA signal must be 
stable during the clock low to high transition and data must change only 
when the clock (SCL) line is low. 

!image ..\img\i2c1.img


!subsubnode RANDOM READ PROTOCOL & SOFTWARE

!image ..\img\i2c2.img
 
The slave address is 1010000. The eight bit is the R/W bit.

Random read operations allow the master to access any memory location in a 
random manner. Before issuing the slave address with the R/W bit set to 
one (Read), the master must first perform a dummy write operation. The 
master issues the start condition, slave address and then the word address 
it is to read. After the word address ACK, the master immediately 
re-issues the start condition and the slave address with the R/W bit set 
to one. This will be followed by an ACK from the slave and then by the 
eight bit word. The master will not ACK the transfer but will issue a stop 
and the slave stops transmission and goes into standby.

The device that controls the transfer is referred to as the master (SDR60 
chip) and the device that receives the data (EEPROM) is referred to as the 
slave device. The master will always start a data transfer (SDA line) and 
will provide the serial clock (SCL line) for synchronization.

The 060 CPU must drive the SCL and SDA lines. These lines are connected to 
2 pins of the logic chip. 

The address $F00xxxxx is used for SCL and $F08xxxxx is used for SDA signal.

!begin_verbatim
SCL (Clock)
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG READ  at $F0000000   READ from SCL
                          Value is available on D1
                          of the CPU data bus.
SDA (Data)
LONG WRITE at $F0800000   WRITE 0 to SDA
LONG WRITE at $F0C00000   WRITE 1 to SDA
LONG READ  at $F0000000   READ from SDA
                          Value is available on D0
                          of the CPU data bus.
!end_verbatim

(!U)
EXAMPLE
(!u)

If you want to read the Byte #3 from the EEPROM :

!begin_verbatim
START condition
LONG WRITE at $F0800000   WRITE 0 to SDA 
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL

SLAVE ADDRESS (Write at 1010000)
Write 1
LONG WRITE at $F0C00000   WRITE 1 to SDA
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL
Write 0
LONG WRITE at $F0800000   WRITE 0 to SDA
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL
...
Repeat for the values 10000 (the last 0 is for write)

ACK condition
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG READ  at $F0000000   READ from SDA If =0, its an ACK
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL


WORD ADDRESS DATA (# 3 in this example)
Write 0
LONG WRITE at $F0800000   WRITE 0 to SDA
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL
...
Repeat 5 times

Write 1
LONG WRITE at $F0C00000   WRITE 1 to SDA
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL
...
Repeat 1 time

ACK condition
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG READ  at $F0000000   READ from SDA If =0, its an ACK
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL

START condition immediately after ACK
LONG WRITE at $F0C00000   WRITE 1 to SDA
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG WRITE at $F0800000   WRITE 0 to SDA 
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL

SLAVE ADDRESS (Read at 1010000)
Write 1
LONG WRITE at $F0C00000   WRITE 1 to SDA
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL
Write 0
LONG WRITE at $F0800000   WRITE 0 to SDA
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL
...
Repeat same procedure for the values 10001 (the last 1 is for read)

ACK condition
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG READ  at $F0000000   READ from SDA If =0, its an ACK
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL

READ WORD DATA
Bit#7
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG READ  at $F0000000   READ from SDA DATA Bit#7
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL
Bit#6
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG READ  at $F0000000   READ from SDA DATA Bit#6
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL
...
Repeat 6 times

Clock cycle (NO ACK)
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG WRITE at $F0000000   WRITE 0 to SCL Falling edge of SCL

STOP condition
LONG WRITE at $F0800000   WRITE 0 to SDA
LONG WRITE at $F0400000   WRITE 1 to SCL Rising edge of SCL
LONG WRITE at $F0C00000   WRITE 1 to SDA 
!end_verbatim


!subnode DIMM SDRAM for CT60

The CT60 supports the modern PC100/133 standard SDRAM DIMMs, and the 
obsolet/uneeded are not accepted.

GOOD SDRAM DIMMs for CT60

!begin_itemize
!item PC100 & PC133 CL2.
!item Must be UNBUFFURED type.
!item Must be 64-bits (no parity or ECC = 72 / 80 bits).
!end_itemize

!begin_table [|l|c|c|l|c|c|r|r|] !hline
Module !! Nbr   !! Nbr   !! Chip     !! RAS  !! CAS  !! PAGE   !! Refresh  
Config !! chips !! banks !! organiz  !! Addr !! Addr !! Lentgh !! Rate (uS)
!hline
64 MB  !!  4     !! 2    !! 4Mx16b   !! 12   !!  8   !!  4 KB  !! 15.625
64 MB  !!  8     !! 1    !! 8Mx8b    !! 12   !!  9   !!  8 KB  !! 15.625 
64 MB  !!  4     !! 1    !! 8Mx16b   !! 12   !!  9   !!  8 KB  !! 15.625 
!hline
128 MB !!  8     !! 2    !! 8Mx8b    !! 12   !!  9   !!  8 KB  !! 15.625
128 MB !!  4     !! 2    !! 8Mx16b   !! 12   !!  9   !!  8 KB  !! 15.625
128 MB !!  8     !! 1    !! 16Mx8b   !! 12   !!  10  !! 16 KB  !! 15.625
128 MB !!  4     !! 1    !! 16Mx16b  !! 13   !!  9   !!  8 KB  !! 7.8125
!hline
256 MB !!  8     !! 2    !! 16Mx8b   !! 12   !!  10  !! 16 KB  !! 15.625
256 MB !!  4     !! 2    !! 16Mx16b  !! 13   !!  9   !!  8 KB  !! 7.8125
256 MB !!  8     !! 1    !! 32Mx8b   !! 13   !!  10  !! 16 KB  !! 7.8125
!hline
512 MB !!  8     !! 2    !! 32Mx8b   !! 13   !!  10  !! 16 KB  !! 7.8125
512 MB !!  4     !! 2    !! 32Mx16b  !! 13   !!  10  !! 16 KB  !! 7.8125
!hline
!end_table

(!B)
NOT SUPPORTED SDRAM DIMMs
(!b)

!begin_itemize
!item All DIMM with chips density < 64Mbits : 8MB, 16MB & 32MB DIMMs. All 
DIMMs with 2 logical banks chips = obsolet (CT60 needs 4 logical banks chips). 
!item REGISTERED / BUFFURED DIMMs (generally for Work Stations & Servers, 
not PC). 
!item 512 MB DIMM with one physical bank (only 1 side populated).
!end_itemize

(!B)
REMARK :
(!b)

Don't confuse SDRAM banks (2 or 4) with physical banks (1= Single Size or 
2 = Double Size) !

(!B)
PERFORMANCES : 
(!b)

The better system performances is obtained with 16 KB page length DIMMs.


!subnode 060 BURST with SDRAM

The CT60 bus clock = the 060 clock (060 in 'Full Bus mode').

The 060 uses (!B) LINE BURST (!b) to & from the system memory. SDRAM is 
well adapted for a such processor !

A BURST LINE is a length of (!B) 4 LONG-WORDs (16 Bytes) (!b) that are 
transferred with only : 

(!B) PAGE HIT (!b) (access to a logical SDRAM page already open) :

!begin_itemize
!item 3,1,1,1 = 6 cycles for Burst Writes. Rate is 16 Bytes / 6 cycles = 
178 MBytes/s (Each access in the same page). 
!item 5,1,1,1 = 8 cycles for Burst Reads. Rate is 16 Bytes / 8 cycles  = 
132 MBytes/s (Each access in the same page).
!end_itemize

(!B) PAGE MISS (!b) (access to a new logical SDRAM page (must be 
precharged and open) : 

!begin_itemize
!item 7,1,1,1 = 10 cycles for Burst Writes. Rate is 16 Bytes / 10 cycles = 
107 MBytes/s (Each access in a new page).
!item 9,1,1,1 = 12 cycles for Burst Reads. Rate is 16 Bytes / 12 cycles  = 
89 MBytes/s (Each access in a new page).
!end_itemize

The CT60 uses the 060 at the top of the possible performances with the 
mighty (!B) COPYBACK (!b) mode ! Instead of the WRITETROUGH mode like 
other TOS machines !

(!B)
Copyback mode is active for all SDRAM memory area.
(!b)

Copyback mode allows the 060 to write into the cache without writting into 
the SDRAM, what is so more performant ! The cache lines are pushed into 
SDRAM only when needed (060 needs place by example). With (!B) two 8Kbytes 
caches, (!b) it gives to coders the possibility to do some incredibly speed 
routs residing at 100% into the caches !

The 060 uses BURST transfers with SDRAM in 99% of the cases. Here are the 
cases when the 060 don't burst, this means, transfers Bytes, Words & 
Long-Words :


(!B)
Byte, Word, and Long-Word READ Transfer Cycles from SDRAM
(!b)

Accesses that are implicitly NONCACHABLE :

!begin_itemize
!item Locked Read-Modify-Write accesses.
!item Table Searches.
!end_itemize

Accesses that are not allocate in the data cache on a read miss :

!begin_itemize
!item Exception Vector Fetches.
!item Exception stack Deallocation for an RTE Instruction.
!end_itemize

(!B)
Byte, Word, and Long-Word WRITE Transfer Cycles to SDRAM
(!b)

Accesses that are implicitly NONCACHABLE :

!begin_itemize
!item Locked Read-Modify-Write accesses.
!item Table Searches.
!end_itemize

Accesses that are not allocate in the data cache on a write miss :
!begin_itemize
!item Exception stacking.
!end_itemize

Cache Line pushes for lines containing a single dirty Long-word.

Write to WRITETHROUGH pages (ST-RAM !).

(!B)
Remark :
(!b)

For those of you who are a bit familiar with 64-bit processors like PPC, 
don't forget that the syntax for data size is not the same : 

(!B)
With 32-Bit processors :
(!b)
!begin_itemize
!item A WORD designates a 16-Bit entity.
!item LONG-WORD designates a 32-Bit entity.
!end_itemize

(!B)
With 64-Bit processors : 
(!b)
!begin_itemize
!item A HALF-WORD designates a 16-Bit entity.
!item A WORD designates a 32-Bit entity.
!item A DOUBLE-WORD designates a 64-Bit entity.
!end_itemize


!subnode INTERRUPTS

CT60 adds some new interrupts for the 060 Bus Slot, re-routing of the 
Falcon INT Set to the second CPU (CPU#2 on the Bus Slot). 

(!B)
The /I6 , and /INT were added on CT60.
(!b)

/I6 is the interrupt from the 060 BUS SLOT and is merged with the others 
from the Falcon. See table below for the priority position.  

/INT is sent by SDR-60 to the CPU#2 to interrupt it. INT is synthetized 
from the /IPL2, /IPL1 & /IPL0 signals and the I6. It is necessary when the 
CPU#2 has to respond the interrupts instead of the primary 060...  

(!U)
060 INTERRUPTS PRIORITY TABLE
(!u)

!begin_table [|l|c|l|l|l|l|c|] !hline
NAME   !! LEVEL !! ACTIVE !! TYPE     !! SOURCE           !! IVR   !! PRIORITY
!hline
I6     !! 6     !! Low    !! Software !! CT60 Bus Slot    !! 1,1,1 !! Highest
INT6   !! 6     !! Low    !! Software !! F030 Bus Slot    !! 1,1,0 !!    ^
MFPINT !! 6     !! Low    !! Software !! F030 MFP         !! 1,1,0 !!    |
DSPREQ !! 6     !! Low    !! Software !! F030 DSP         !! 1,1,0 !!    |
INT5   !! 5     !! Low    !! Software !! F030 SCC         !! 1,0,1 !!    |
VBL    !! 4     !! Low    !! Auto     !! F030 VIDEL VSync !! 1,0,0 !!    |
INT3   !! 3     !! High   !! Software !! F030 Bus Slot    !! 0,1,1 !!    |
HBL    !! 2     !! Low    !! Auto     !! F030 VIDEL HSync !! 0,1,0 !!    v
INT1   !! 1     !! High   !! Software !! F030 Bus Slot    !! 0,0,1 !! Lowest
!hline
!end_table

(!B) 
INT1 & INT3 are NO MORE SUPPORTED with CT60 !
(!b)

INT6 is also named MFPINT on atari documents because it is daisy chained 
with the MFP. 

To allow the PPC to read the level of the falcon re-routed interrupts, the 
CT60 furnishes a register called (B!) IVR (Interrupt Vector Register). (!b)
The IVR column gives you the binary values encoded by the SDR60 chip...

Note that the INT6, MFPINT and DSPREQ Interrupts are chained on the level 
6 line... (its a stock Falcon feature !). 

It is planned that the PPC board will contain a mechanism register to 
generate a '68K like' INT ACK cycle and receive the software Vector from 
the Falcon data bus. On CT60, the IVR contains only the level of the 
pending INT...

(!U)
CPU#2 INTERRUPT
(!u)

!begin_table [|l|c|l|l||l|] !hline
NAME !! LEVEL !! ACTIVE !! TYPE !! SOURCE
!hline
INT  !! None  !! Low     !! Auto !! F030 IPLx and CT60 I6
!hline
!end_table

This interrupt is compatible with the PowerPC INT...


!subnode CHIPSETS pinouts

!subsubnode SDR-60      

!begin_verbatim
  1 VCC                            73 VCC                           
  2 rstf                           74 cs1                           
  3 PGND                           75 cs0                           
  4 ta                             76 cas                           
  5 PGND                           77 we                            
  6 PGND                           78 a31                           
  7 PGND                           79 a30                           
  8 VCC                            80 a29                           
  9 PGND                           81 a28                           
 10 a10                            82 a27                           
 11 a11                            83 a26                           
 12 a12                            84 VCC                           
 13 a13                            85 a25                           
 14 a14                            86 a24                           
 15 a15                            87 a23                           
 16 a2                             88 a22                           
 17 a3                             89 GND                           
 18 GND                            90 GND                           
 19 a4                             91 a21                           
 20 a5                             92 a20                           
 21 a6                             93 a19                           
 22 a7                             94 a18                           
 23 a8                             95 a17                           
 24 a9                             96 a16                           
 25 dm3                            97 tbi                           
 26 dm1                            98 PGND                          
 27 dm2                            99 GND                           
 28 dm0                            100 TEST SDR                          
 29 GND                            101 TEST SDR                          
 30 clk500                         102 tci                           
 31 cs3                            103 rst60                          
 32 clk                            104 PGND                          
 33 PGND                           105 PGND                          
 34 PGND                           106 int                           
 35 cs2                            107 PGND                          
 36 GND                            108 GND                           
 37 VCC                            109 VCC                           
 38 PGND                           110 PGND                          
 39 ideled                         111 ipl2f                         
 40 d2                             112 ipl1                          
 41 d1                             113 i6                            
 42 VCC                            114 GND                           
 43 d0                             115 ipl2                          
 44 PGND                           116 bs1                           
 45 PGND                           117 ts                            
 46 ma12                           118 tt1                           
 47 GND                            119 PGND                           
 48 ma11                           120 PGND                           
 49 ba1                            121 ipl0                          
 50 ba0                            122 TDO                           
 51 ma10                           123 GND                           
 52 ma9                            124 siz1                          
 53 ma8                            125 rsto                          
 54 ma7                            126 eeda                          
 55 VCC                            127 VCC                           
 56 ma6                            128 thcs                          
 57 ma5                            129 rw                            
 58 ma4                            130 siz0                          
 59 ma3                            131 Reserved                          
 60 ma2                            132 PGND                           
 61 ma1                            133 PGND                           
 62 GND                            134 eecl                          
 63 TDI                            135 bs0                           
 64 ma0                            136 bs2                           
 65 TMS                            137 bs3                           
 66 PGND                           138 thck                          
 67 TCK                            139 ipl0f                         
 68 PGND                           140 ipl1f                         
 69 PGND                           141 VCC                           
 70 PGND                           142 thdi                          
 71 ras                            143 rst                          
 72 GND                            144 GND
!end_verbatim
                               

!subsubnode ABE-60                     
   
!begin_verbatim
  1 VCC                            73 VCC                           
  2 avec                           74 d28                           
  3 a13                            75 d27                           
  4 ct60                           76 d26                           
  5 a14                            77 d25                           
  6 a15                            78 d24                           
  7 ta                             79 d23                           
  8 VCC                            80 d22                           
  9 bs0                            81 d21                           
 10 flhoe                          82 d20                           
 11 flhwe                          83 d19                           
 12 dtkcmb                         84 VCC                           
 13 halt                           85 d18                           
 14 a2                             86 d17                           
 15 a3                             87 d16                           
 16 tt0                            88 d15                           
 17 tm0                            89 GND                           
 18 GND                            90 GND                           
 19 bg1                            91 d14                           
 20 tm1                            92 d13                           
 21 bg2                            93 d12                           
 22 ts                             94 d11                           
 23 bg0                            95 d10                           
 24 tt1                            96 d9                            
 25 exp/  - TEST ABE               97 d8                            
 26 exp2/ - TEST ABE               98 d7
 27 tm2                            99 GND                           
 28 as                             100 d6                            
 29 GND                            101 d5                            
 30 clk500                         102 d4                            
 31 bs1                            103 d3                            
 32 clk                            104 d2                            
 33 bs2                            105 d1                            
 34 i6                             106 br2                           
 35 dtk                            107 d0                            
 36 GND                            108 GND                           
 37 VCC                            109 VCC                           
 38 clkf                           110 fd15                          
 39 a2f                            111 fd14                          
 40 fc2                            112 fd13                          
 41 slp                            113 fd12                          
 42 VCC                            114 GND                           
 43 bs3                            115 fd11                          
 44 a3f                            116 fd10                          
 45 bb                             117 fd9                           
 46 fc1                            118 fd8                           
 47 GND                            119 fd7                           
 48 a16                            120 fd6                           
 49 a17                            121 fd5                           
 50 a18                            122 TDO                           
 51 a19                            123 GND                           
 52 a20                            124 fd4                           
 53 a21                            125 fd3                           
 54 a22                            126 fd2                           
 55 VCC                            127 VCC                           
 56 a23                            128 fd1                           
 57 a24                            129 fd0                           
 58 a25                            130 bg30                          
 59 a26                            131 uds                           
 60 a27                            132 lds                           
 61 a28                            133 a1f                           
 62 GND                            134 berr                          
 63 TDI                            135 br0                           
 64 a29                            136 rw                            
 65 TMS                            137 fc0                           
 66 a30                            138 br1                           
 67 TCK                            139 abdir                         
 68 a31                            140 bgk                           
 69 d31                            141 VCC                           
 70 d30                            142 tea                           
 71 d29                            143 rst                           
 72 GND                            144 GND
!end_verbatim


!node Annexes

!subnode Carte

!image ..\img\board.img


!subnode Connecteurs

Connecteur F030 X4 (alimentation carte m‚re)

!begin_table [|c|l|l|l|] !hline
Pin Carte !! Signal !! Commentaire       !! Couleur fil
!hline
   1      !! +5V    !! +5V (sortie)      !! Rouge
   2      !! GND    !! Ground (masse 0V) !! Noir
   3      !! GND    !! Ground (masse 0V) !! Noir
   4      !! +12V   !! +12V (sortie)     !! Bleu (ou jaune)
!hline
!end_table

Connecteur ATX POWER X5

!begin_table [|c|l|l|l|] !hline
Pin Carte !! Signal !! Commentaire              !! Couleur fil
!hline
   1      !! +3.3V  !! +3.3V (entr‚e)           !! Orange
   2      !! +3.3V  !! +3.3V (entr‚e)           !! Orange
   3      !! GND    !! Ground (masse 0V)        !! Noir
   4      !! +5V    !! +5V (entr‚e)             !! Rouge
   5      !! GND    !! Ground (masse 0V)        !! Noir
   6      !! +5V    !! +5V (entr‚e)             !! Rouge 
   7      !! GND    !! Ground (masse 0V)        !! Noir
   8      !! PWOK   !! Power OK (inutilis‚)     !! Gris
   9      !! +5VSB  !! +5V Standby (entr‚e)     !! Violet
   10     !! +12V   !! +12V (entr‚e)            !! Jaune
   11     !! +3.3V  !! +3.3V (entr‚e)           !! Orange
   12     !! -12V   !! -12V                     !! Bleu
   13     !! GND    !! Ground (masse 0V)        !! Noir
   14     !! PSON   !! Power Supply ON (sortie) !! Vert
   15     !! GND    !! Ground (masse 0V)        !! Noir
   16     !! GND    !! Ground (masse 0V)        !! Noir
   17     !! GND    !! Ground (masse 0V)        !! Noir
   18     !! -5V    !! -5V (entr‚e)             !! Rouge
   19     !! +5V    !! +5V (entr‚e)             !! Rouge
   20     !! +5V    !! +5V (entr‚e)             !! Rouge
!hline
!end_table
                  
Connecteur TOWER X6

!begin_table [|c|l|l|] !hline
Pin Carte !! Signal   !! Commentaire
!hline
   1      !! PWR_SW+  !! Power Switch 
   2      !! PWR_SW-  !! 
   3      !! TRB_SW+  !! Turbo Switch
   4      !! TRB_SW-  !! 
   5      !! IDE_LED+ !! Led IDE
   6      !! IDE_LED- !!
   7      !! RST_SW+  !! Reset Switch
   8      !! RST_SW-  !! 
   9      !! PWR_LED+ !! Power led
   10     !! NC
   11     !! PWR_LED- !! 
!hline
!end_table

Connecteur F030 BOOST X9

!begin_table [|c|l|l|] !hline
Pin Carte !! Signal !! Commentaire
!hline
   1      !! GND1   !! Ground (masse 0V)
   2      !! MCLK   !! Master Clock CT60 (sortie) vers L102 carte m‚re
   3      !! GND2   !! Ground (masse 0V)
   4      !! CLK32  !! Clock 32MHz (entr‚e) vers L102 pin en l'air
   5      !! AC_K   !! Clock 500Khz Keyboard (sortie) vers ACIA U52 pins 3/4
   6      !! AC_M   !! Clock 500Khz Midi (sortie) vers ACIA U24 pins 3/4
   7      !! DCLK   !! DSP Clock (sortie) vers DSP U38 pin 74
   8      !! GND3   !! Ground (masse 0V)
   9      !! DTKCMB !! Dtack Combel (entr‚e) vers GAL U63 pin 8
   10     !! GND4   !! Ground (masse 0V) inutilis‚
!hline
!end_table
!image ..\img\dsp.img
!image ..\img\clock.img


!subnode Raccourcis clavier TOS

!begin_verbatim
CTRL:          Si appuy‚ avant le logo Atari, saute l'initialisation du
               g‚n‚rateur d'horloge (CTCM) et le BIOS PCI (CTPCI).
               Boot sans dossier AUTO et ACC.
ALT:           Si appuy‚ avant le logo Atari, saute l'initialisation du
               g‚n‚rateur d'horloge (CTCM) et le BIOS PCI (CTPCI).
               Supprime le cache si appuy‚ avant l'init SDRAM.
               Boot sans disque si appuy‚ aprŠs.
SHIFTL-SHIFTR: Boot sans SDRAM si appuy‚ avant le logo Atari.
SHIFTL:        Affiche les informations sur le module SDRAM.
CTRL-ALT-UNDO: Init NVM et ParamŠtres en Flash si appuy‚ pendant le test 
               m‚moire jusqu'au reset. Vous avez besoin de r‚gler le 
               d‚lais au boot … 60 secondes avec le CPX de configuration.
CTRL-ALT-
SHIFTR-SHIFTL: Lance les Diagnostiques Atari si appuy‚ avant le logo 
               Atari (si non ‚cras‚ par drivers.hex).  
!end_verbatim


!node Contacts

!begin_verbatim
Hardware :
Rodolphe CZUBA
rodolphe.czuba@free.fr
http://www.czuba-tech.com

Flash Tool, Configuration, et systŠme :
Didier MEQUIGNON
aniplay@wanadoo.fr
!end_verbatim
 
!end_document
